webpackJsonp([21,1],{1130:function(t,e,i){"use strict";function s(t,e,i){e.toggleClass("i-hidden",""===t.val()),i.fire(t.val())}function o(t){var e,i,o,n=$(d);return t.addClass&&n.addClass(t.addClass),t.withoutControls&&n.addClass("tv-search-row--without-controls"),e=n.find(".js-input-control"),i=n.find(".js-reset-button"),t.placeholder&&e.attr("placeholder",t.placeholder),i[0].addEventListener("click",function(){e.val("").trigger("input").focus()}),o=new a.a,e.on("input propertychange",s.bind(null,e,i,o)),s(e,i,o),{$control:n,$input:e,inputChangedDelegate:o}}var n,a,r,l,c,d;Object.defineProperty(e,"__esModule",{value:!0}),e.createSearchControl=o,n=i(8),a=i.n(n),r=i(382),i.n(r),l=i(1131),i.n(l),c=i(1132),i.n(c),d='<div class="tv-search-row"><input class="tv-search-row__input js-input-control" type="text" name="q" value="" autocomplete="off"><span class="tv-search-row__input-reset i-hidden js-reset-button">'+r+'</span><span class="tv-search-row__search-icon">'+l+"</span></div>"},1131:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18px" height="18px"><path fill-rule="evenodd" d="M12.5 11h-.79l-.28-.27A6.47 6.47 0 0 0 13 6.5 6.5 6.5 0 1 0 6.5 13c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L17.49 16l-4.99-5zm-6 0C4.01 11 2 8.99 2 6.5S4.01 2 6.5 2 11 4.01 11 6.5 8.99 11 6.5 11z"/></svg>'},1132:function(t,e){},1133:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var r,l;Object.defineProperty(e,"__esModule",{value:!0}),e.AddSymbolCheckbox=void 0,r=i(154),l=s(r),e.AddSymbolCheckbox=function(t){function e(t){o(this,e),t.checked=TVSettings.getBool("showAddSymbolDialog.checkboxState",!0);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.$checkbox.change(function(){setTimeout(function(){TVSettings.setValue("showAddSymbolDialog.checkboxState",i.checked)})}),i}return a(e,t),e}(l.default)},1260:function(t,e,i){"use strict";var s,o,n,a,r,l,c,d,h,u;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"FavoriteScriptsModel",function(){return u}),s=i(26),i.n(s),o=i(99),n=i(32),a=i.n(n),r=i(8),l=i.n(r),c=i(12),i.n(c),d={FAV_KEY:"studyMarket.favorites",FAV_EXTRA_KEY:"studyMarket.favorites.extra"},h=null,u=function(){function t(){var t=this;this._previousFavorites=[],this._favorites=[],this._favoritesExtra={},this._favoritesChanged=new l.a,this.loadFavs(),o.TVXWindowEvents.on("StudyFavoritesChanged",function(e){var i=JSON.parse(e);t._updateFavorites(i.favorites||[]),
t._updateFavoritesExtra(i.favoritesExtra||{})}),window.loginStateChange.subscribe(null,function(){t.loadFavs()})}return t.prototype.loadFavs=function(){var t=s.getJSON(d.FAV_KEY,[]),e=s.getJSON(d.FAV_EXTRA_KEY,{}),i=this._migrate(t,e);this._updateFavorites(i.favs),this._updateFavoritesExtra(i.favsExtra)},t.prototype.isFav=function(t){0===this._favorites.length&&this.loadFavs();var e=this.favId(t);return-1!==this._favorites.indexOf(e)},t.prototype.favorite=function(t,e){var i,s,n,a;0!==this._favorites.length&&0!==Object.keys(this._favoritesExtra).length||this.loadFavs(),i=this.favId(t),s=this.favorites(),n=this.favoritesExtra(),a=s.indexOf(i),-1!==a?(s.splice(a,1),delete n[i]):(s.push(i),void 0!==e&&(n[i]=e)),this._updateFavorites(s),this._updateFavoritesExtra(n),this._saveFavs(s,n),o.TVXWindowEvents.emit("StudyFavoritesChanged",JSON.stringify({favorites:s,favoritesExtra:n}))},t.prototype.favId=function(t){return a.a.cutScriptIdPart(t)||a.a.cutFullId(t)},t.prototype.previousFavorites=function(){return this._previousFavorites.slice()},t.prototype.favorites=function(){return this._favorites.slice()},t.prototype.favoritesExtra=function(){return Object.assign({},this._favoritesExtra)},t.prototype.favoritesChanged=function(){return this._favoritesChanged},t.getInstance=function(){return null===h&&(h=new t),h},t.prototype._saveFavs=function(t,e){s.setJSON(d.FAV_KEY,t),s.setJSON(d.FAV_EXTRA_KEY,e)},t.prototype._migrate=function(t,e){var i,s,o=[],n={};for(i=0;i<t.length;i++)s=this.favId(t[i]),-1===o.indexOf(s)&&(o.push(s),n[s]=e[t[i]]);return{favs:o,favsExtra:n}},t.prototype._updateFavorites=function(t){Object(c.deepEquals)(this._favorites,t)[0]||(this._previousFavorites=this.favorites(),this._favorites=t,this._favoritesChanged.fire(this.favorites()))},t.prototype._updateFavoritesExtra=function(t){this._favoritesExtra=t},t}()},1261:function(t,e){},78:function(t,e,i){"use strict";function s(t){var e=t.type||"popup";return delete t.type,"modal"===e?new o.TVModal(t):new n.TVPopup(t)}var o,n;Object.defineProperty(e,"__esModule",{value:!0}),e.createDialog=s,o=i(368),n=i(955)},822:function(t,e,i){"use strict";(function(e,s){function o(t,i){this.HIGHLIGHT_STUDY_NUM_FLICKS=2,this.SCROLL_TOLERANCE=10,this._BASIC_STUDIES_PACKAGE_NAME="tv-basicstudies",this._CUSTOM_STUDIES_PACKAGE_NAME="Script$USER",this._PUBLISHED_STUDIES_PACKAGE_NAME="Script$PUB",this._STANDARD_STUDIES_PACKAGE_NAME="Script$STD",this._SCRIPTING_PACKAGE_NAME="tv-scripting",this._FUNDAMENTAL_PACKAGE_NAME="Script$EDGR",this._BASIC_STUDIES_PAGE_NAME=a.enabled("plain_studymarket")?$.t("Technical Analysis"):$.t("Built-ins"),this._FUNDAMENTALS_PAGE_NAME=$.t("Fundamentals"),this._dialog=null,this._selectedStudy=null,this._keyDownListener=null,this._shortCutsLockId=null,this.visibilityChanged=new e,this._chartWidgetCollection=t,this._chart=t.activeChartWidget.value(),this._options=$.extend({},this.DEFAULT_OPTIONS,i||{}),this.concretizeOptions(),this._user=window.user,this.setup(),this.favsModel=C.getInstance(),
this.favsModel.favoritesChanged().subscribe(this,this.updateFavorites)}var n,a,r,l,c,d,h,u,p,_,g,f,v,y,S,b,m,E,C,A,w,P,T,I;i(97),n=i(95).isFeatureEnabled,a=i(4),r=i(6).assert,l=i(42),c=i(147).SidebarCustomScroll,d=i(32),h=i(78).createDialog,i(70).createConfirmDialog,u=i(237).showNoticeDialog,p=i(1130).createSearchControl,_=i(77),g=i(26),f=i(220),v=i(119).bindToInput,y=i(1133).AddSymbolCheckbox,S=i(235),b=i(151),m=i(401).KeyboardListener,E=i(122),C=i(1260).FavoriteScriptsModel,A=i(5).getLogger("Chart.StudyMarketDialog"),i(1261),i(400),i(981),w='<div class="tv-insert-indicator-dialog__body js-dialog__scroll-wrap"><div class="tv-insert-indicator-dialog__left-panel">{{^minimized}}<div id="js-search-placeholder"></div>{{/minimized}}<div class="tv-insert-indicator-dialog__left-panel-content-wrapper js-left-panel-wrapper"><div class="tv-insert-indicator-dialog__tabs-viewport js-tabs-viewport"><div class="tv-insert-indicator-dialog__tabs-container js-tabs-container"></div></div></div></div><div class="tv-insert-indicator-dialog__right-panel js-right-panel">{{#minimized}}{{#withSearch}}<div id="js-search-placeholder"></div>{{/withSearch}}{{/minimized}}<div class="tv-insert-indicator-dialog__pages js-pages"></div></div></div>',P='<div class="tv-insert-indicator-dialog__tabs-group"><div class="tv-insert-indicator-dialog__tab tv-insert-indicator-dialog__tab--group-head js-tab js-tab-head">{{title}}<span class="tv-caret"></span></div><div class="tv-insert-indicator-dialog__tabs"></div></div>',T='<div class="js-study-item tv-insert-study-item {{^withFavorites}}i-without-stars{{/withFavorites}}">{{#withFavorites}}<div class="tv-insert-study-item__favorite-icon js-favorite-icon"><span class="tv-insert-study-item__star tv-insert-study-item__star--filled">'+i(972)+'</span><span class="tv-insert-study-item__star tv-insert-study-item__star--empty">'+i(973)+'</span></div>{{/withFavorites}}<div class="tv-insert-study-item__title"><div class="tv-insert-study-item__title-text" title="{{titleTooltip}}">{{{title}}}</div></div></div>',I=!TradingView.onWidget()&&n("hide_fundamentals"),o.prototype.destroy=function(){},o.prototype.setup=function(){this._initialized=!1,this._loadMore=null,this._$economyTabInput=null,this._$symbolSearchPopup=null,this._market=null,this._studies=null,this._packagesWithTabNames={},this._pages={},this._tabs={},this._subProductIds={},this.favsChanged=new e,this._previousInviteOnlyStudiesIds=[],this.studiesReady=new $.Deferred,this.marketPagesReady=new $.Deferred,this._pubSearchCount=[0,0,0],this._pubSearchCanLoad=[!0,!0,!0],this._pubSearchEntries=[],this._pubSearchCache=[],this._pubSearchDfd=null,this._pubSearchPageShown=!1,this._w_market_tabs=null,this._w_technical_tabs=null},o.prototype.init=function(){if(this._initialized)return void this.getStudyInfo();this.setupMarketInfo(),this.getStudyInfo(),this.setUser(this._user),this.prepareLayout(),this.attachHandlers(),this._initialized=!0},o.prototype.DEFAULT_OPTIONS={onWidget:!1,hideMarketPages:!1,selectBasicPage:!0,minimized:!1,searchKeywords:{earning:RegExp("EPS"),
earnings:RegExp("EPS"),"trailing twelve months":RegExp("TTM")}},o.prototype._PAGE_KEY="studyMarket.page",o.prototype._ECONOMY_TAB=$.t("Economy & Symbols"),o.prototype._PUB_SEARCH_ENTRIES_ON_PAGE=20,o.prototype.loadFavorites=function(){this.favsModel.loadFavs()},o.prototype.concretizeOptions=function(){a.enabled("study_market_minimized")&&(this._options.hideMarketPages=!0,this._options.selectBasicPage=!0,this._options.minimized=!0),this._options.onWidget&&(this._options.hideMarketPages=!0)},o.prototype.setupMarketInfo=function(){},o.prototype.getStudyInfo=function(){this._chart.withModel(this,function(){this.setupStudyInfo()})},o.prototype.setupStudyInfo=function(){var t=this._chartWidgetCollection.activeChartWidget.value().model().studiesMetaData();t.length;this._studies={},t=t.filter(function(t){return!this.isHidedStudy(t)},this),t.forEach(function(t){var e,i=this.getStudyPackageName(t.id);!(this._options.minimized&&i!==this._BASIC_STUDIES_PACKAGE_NAME||this._options.onWidget&&(d.isScriptStrategy(t)||i===this._CUSTOM_STUDIES_PACKAGE_NAME))&&(e=this.resolvePackageName(i),r(void 0!==e,"Cannot resolve packageName "+i),this._studies[e]=this._studies[e]||[],this._studies[e].push(t))}.bind(this),this),this.studiesReady.resolve()},o.prototype.setupAddonsInfo=function(){var t,e,i,s,o,n=[],a={};for(t in this._market.products)e=this._market.products[t],pro.hasPackage(t)&&e.subproduct_ids&&e.subproduct_ids[0]&&(i=e.subproduct_ids[0],s=i.split("$")[1],a[s]=t,n.push(ScriptLib.requestPineAddons(s)));return o=this,Promise.all(n).then(function(t){return t.reduce(function(t,e){var i,s;return e&&e.length?(i=e[0].scriptIdPart.split("_")[0],s=[],o._fillScriptsMetainfo(e,s),t[a[i]]=s,t):t},{})})},o.prototype.resolvePackageName=function(t){return t in this._subProductIds?this._subProductIds[t]:t},o.prototype.setUser=function(t){window.is_authenticated?this.setupUserData(t):this.setAnonymous()},o.prototype.setupUserData=function(t){this._user=t,this.loadFavorites(),this.updateMarketPages()},o.prototype.setAnonymous=function(){this.setupUserData(null),this.favsChanged.fire()},o.prototype.isHidedStudy=function(t){var e,i,s;return this._options.onWidget&&(e="IchimokuCloud@tv-basicstudies"===t.id),i=!1,s=!1,!!t.is_hidden_study&&!e||i&&!s},o._breakpointDevice="phone-vertical",o.prototype._switchPagesContainer=function(t,e){this._options.minimized||(t===o._breakpointDevice?this._w_pages.detach().appendTo(this._widget.find(".js-left-panel-wrapper")):e===o._breakpointDevice&&this._w_pages.detach().appendTo(this._widget.find(".js-right-panel")))},o.prototype.prepareLayout=function(){this._widget=$(s.render(w,{withSearch:a.enabled("study_dialog_search_control"),minimized:this._options.minimized})),this._w_tabs=this._widget.find(".js-tabs-container"),this._w_pages=this._widget.find(".js-pages"),this._loadMore=null,this.preparePages(),
!this._options.selectBasicPage||this._options.fundamentalsOnly||f.device===o._breakpointDevice&&!this._options.minimized?this._options.fundamentalsOnly&&(f.device!==o._breakpointDevice||this._options.minimized)?this.selectPage(this._FUNDAMENTALS_PAGE_NAME):f.device===o._breakpointDevice&&this.selectPage(""):this.selectPage(this._BASIC_STUDIES_PAGE_NAME),this._scroll=new c(this._widget.find(".js-tabs-viewport"),this._w_tabs,{showBottomShadow:!1});var t='<div class="tv-dialog__section tv-dialog__section--title js-dialog__drag tv-insert-indicator-dialog__title-container js-title-container"><div class="tv-insert-indicator-dialog__back-button js-back-button js-dialog__no-drag">'+i(967)+'</div><div class="js-title-text tv-dialog__title tv-insert-indicator-dialog__title-text">{{{ title }}}</div></div>';this._dialog=h({title:" ",titleTemplate:t,contentWrapTemplate:this._widget,addClass:"tv-insert-indicator-dialog "+(this._options.minimized?"i-minimized":""),width:this._options.minimized?490:842,height:580,withScroll:!1,focusFirstControl:!1,closeOnClickAtOtherDialogs:!1,isClickOutFn:function(t){var e,s=i.c[815];if(s&&(e=s.exports.instance()))return e.isEventOut(t);if(this._$symbolSearchPopup)return this._$symbolSearchPopup[0]!==t.target&&!this._$symbolSearchPopup[0].contains(t.target)&&void 0}.bind(this)}),this._dialog.on("afterClose",this._onDialogClosed.bind(this)),this._dialog.$title.find(".js-back-button").on(Modernizr.touch?"touchend":"click",this.selectPage.bind(this,"")),f.on("changeDevice",function(t,e){t===o._breakpointDevice&&this.currentPage()&&this.currentPage().hasClass("js-marketplace-page")&&this.selectPage(""),t===o._breakpointDevice&&(this._scroll.scrollToStart(),this._updateDialogTitleText()),this._switchPagesContainer(t,e)}.bind(this)),this._switchPagesContainer(f.device,""),this._showHideBackButton(),this.hide()},o.prototype.scrollHandler=function(){var t,e;if(!this._loadMore)return void this._w_pages.off("scroll.loadMoreOnEnd");t=$.map(this._w_pages.children(":visible"),function(t){return $(t).outerHeight(!0)}).reduce(function(t,e){return t+e},0),e=this._widget.find(".js-right-panel").height(),this._w_pages.scrollTop()>t-e-this.SCROLL_TOLERANCE&&(this._w_pages.off("scroll.loadMoreOnEnd"),this._loadMore())},o.prototype._updateDialogTitleText=function(){var t,e,i;if(this._dialog){if(t=""!==this._currentPageTitle,e=f.device!==o._breakpointDevice,!t||e||this._options.minimized)return void this._dialog.setTitleText(this._dialogTitleText);i=this.currentPage(),this._dialog.setTitleText(i.data("fullTitle"))}},o.prototype.currentPage=function(){return this._pages[this._currentPageTitle]},o.prototype.preparePages=function(){this.addSearchPage(),a.enabled("items_favoriting")&&this.addFavoritesPage(),this._options.fundamentalsOnly||this.prepareBasicPage(),this._options.fundamentalsOnly||this.addEconomyPage()},o.prototype.addEconomyPage=function(){var t,e,i=this.addPage(this._ECONOMY_TAB,{withoutTopPadding:!0,noFlex:!0}),s=p({withoutControls:!0,placeholder:$.t("Symbol"),addClass:"tv-insert-indicator-dialog__economy"})
;this._$economyTabInput=s.$input,t=new y({labelRight:$.t("Overlay the main chart")}),this._symbolSearch=v(this._$economyTabInput,{keepFocus:!0,clearAfterAccept:!0,callback:function(e){var i=this._chartWidgetCollection.activeChartWidget.value();i&&i.addSymbol(e,t.checked)}.bind(this),onPopupOpen:function(t){this._$symbolSearchPopup=t,this._$symbolSearchPopup.css("z-index",this._dialog.zIndex)}.bind(this),onPopupClose:function(){this._$symbolSearchPopup=null}.bind(this)}),i.append(s.$control),e=$('<div class="tv-insert-indicator-dialog__economy-content">'),e.append(t.$el),i.append(e)},o.prototype.addFavoritesPage=function(){this.addPage("Favorites",{localizedTitle:$.t("Favorites")}),this.loadFavorites(),this.updateFavorites()},o.prototype.addInvitesOnlyPage=function(){this.addPage("invitesOnly",{localizedTitle:$.t("Invite-Only Scripts")})},o.prototype.prepareBasicPage=function(){var t=this.addPage(this._BASIC_STUDIES_PAGE_NAME,{packageName:this._BASIC_STUDIES_PACKAGE_NAME,technical:!a.enabled("plain_studymarket")});this._basicPage=t,this.studiesReady.done(function(){this.resetBasicPage()}.bind(this))},o.prototype._applyGlobalFilter=function(t){return this._parentSource&&(t=t.filter(d.canBeChild)),t},o.prototype._applyStrategiesFilter=function(t){var e=this._parentSource?"not_strategies":"none";return"not_strategies"!==e&&"only_strategies"!==e||(t=t.filter(function(t){var i=d.isScriptStrategy(t);return"not_strategies"===e?!i:i})),t},o.prototype.resetBasicPage=function(){var t,e,i=this.getPage(this._BASIC_STUDIES_PAGE_NAME);this._studies&&(t=this._studies[this._BASIC_STUDIES_PACKAGE_NAME]||[],e=this._studies[this._STANDARD_STUDIES_PACKAGE_NAME]||[],t=t.concat(e),t=this._applyStrategiesFilter(t),t=this._applyGlobalFilter(t),this.preparePageStudies(i,t))},o.prototype.resetAllPages=function(){this.resetBasicPage(),this.resetCustomScriptPage(),this.resetPublishedScriptPage(),this.resetInvitesOnlyPage()},o.prototype._fillScriptsMetainfo=function(t,e){var i,s,o;for(i=0;i<t.length;i++)s=t[i],o=d.createMetaInfoStub(s,"1"),TradingView.merge(o,d.parseIdString(o.id)),e.push(o)},o.prototype.resetCustomScriptPage=function(){},o.prototype.resetPublishedScriptPage=function(){},o.prototype._createItemsList=function(){return $('<div class="tv-insert-indicator-dialog__items-list">')},o.prototype._createSubGroupItem=function(t){return $('<div class="tv-insert-study-item tv-insert-study-item--subgroup-header">').text(t)},o.prototype._createItemsGroup=function(t,e,i){var s,o=this._createItemsList();return this.fillStudies(o,t,i),s=$('<div class="tv-insert-indicator-dialog__subgroup">'),e.length&&s.append(this._createSubGroupItem(e)),s.append(o),s},o.prototype.addSearchPage=function(){var t,e,i,s=p({addClass:"tv-insert-indicator-dialog__search-control"});this._tabs.search=s.$control.data("title","search"),this._pages.search=$('<div class="tv-insert-indicator-dialog__page tv-insert-indicator-dialog__page--search">').data("title","search"),this._pages.search.data("fullTitle",$.t("Search")),t=null,this._search_value=null,
this._search_input=s.$input,s.inputChangedDelegate.subscribe(null,function(){t&&clearTimeout(t),t=setTimeout(function(){t=null,this.search(this._search_input.val()),this._w_pages.scrollTop(0)}.bind(this),200)}.bind(this)),this._search_input.focus(function(){this.search(this._search_input.val())}.bind(this)),e=this._widget.find("#js-search-placeholder"),e.length&&e.parent()[0].replaceChild(this._tabs.search[0],e[0]),this._w_pages.prepend(this._pages.search),i={},i[b.ENTER]=this._onEnterKeyHandler.bind(this),i[b.UP_ARROW]=this._onUpKeyHandler.bind(this),i[b.DOWN_ARROW]=this._onDownKeyHandler.bind(this),this._keyDownListener=new m("keydown",!1),this._keyDownListener.regHandlers(i)},o.prototype._onEnterKeyHandler=function(t){t.target!==this._$economyTabInput[0]&&(null!==this._selectedStudy?this.insertThisStudy(this._selectedStudy):this._insertStudyByShortDescription())},o.prototype._onUpKeyHandler=function(t){var e,i,s;t.preventDefault(),null!==this._selectedStudy&&(e=this.currentPage().find(".js-study-item"),i=e.index(this._selectedStudy),s=e.eq(i-1),s.length&&i>0&&(this._selectedStudy.removeClass("tv-insert-study-item--selected"),s.addClass("tv-insert-study-item--selected"),this._selectedStudy=s,this._ensureSelectedItemIsVisible()))},o.prototype._onDownKeyHandler=function(t){var e,i,s;t.preventDefault(),null!==this._selectedStudy&&this.currentPage()[0].contains(this._selectedStudy[0])?(e=this.currentPage().find(".js-study-item"),i=e.index(this._selectedStudy),s=e.eq(i+1),s.length&&(this._selectedStudy.removeClass("tv-insert-study-item--selected"),s.addClass("tv-insert-study-item--selected"),this._selectedStudy=s,this._ensureSelectedItemIsVisible())):(this._selectedStudy=this.currentPage().find(".js-study-item").first(),this._selectedStudy.addClass("tv-insert-study-item--selected"))},o.prototype._ensureSelectedItemIsVisible=function(){var t,e,i,s,o,n;null!==this._selectedStudy&&(t=this._w_pages,e=this._selectedStudy[0].getBoundingClientRect(),i=t[0].getBoundingClientRect(),s=this.currentPage()[0].getBoundingClientRect().top,o=e.top-s,n=3,e.top-i.top<0?t.scrollTop(o-n):e.bottom-i.bottom>0&&t.scrollTop(o-i.height+e.height+n))},o.prototype.search=function(t,e,i){function s(t,e,i,s,o,n){t.push(e),t[t.length-1].matchPriority=s,o&&(t[t.length-1].matchIndex=i.match(n).index)}var o,n,r,l,c,d=this;(this._search_value!==t||e)&&(o=this._pages.search,n=[],r=function(t){return t.replace(/[!-\/[-^{-}]/g,"\\$&")},""!==t&&(l=t.split("").map(function(t,e){var i=r(t);return 0!==e&&(i="[/\\s-]"+i),"("+i+")"}).join("(.*?)")+"(.*)",n.push({fullMatch:RegExp("("+r(t)+")","i"),re:RegExp("^"+l,"i"),reserveRe:RegExp(l,"i"),fuzzyHighlight:!0}),t.toLowerCase()in this.DEFAULT_OPTIONS.searchKeywords&&n.push({fullMatch:this.DEFAULT_OPTIONS.searchKeywords[t.toLowerCase()],re:this.DEFAULT_OPTIONS.searchKeywords[t.toLowerCase()],fuzzyHighlight:!1})),this._search_value=t,c=$.Deferred(),d._currentAsyncSearchDfd=c,a.enabled("plain_studymarket")?c.resolve([]):PublishedScript.suggest(t).done(function(t){var e=[];t&&t.results;c.resolve(e)}).fail(function(){
c.resolve([])}),c.done(function(e){var i,a,r,l,h,u,p,_,g,f,v,y,S,b,m,E,C,A,w,P,T,k;if(d._currentAsyncSearchDfd===c){for(i=Object.keys(d._studies),i.indexOf(d._PUBLISHED_STUDIES_PACKAGE_NAME)<0&&i.push(d._PUBLISHED_STUDIES_PACKAGE_NAME),i.sort(),a=[d._BASIC_STUDIES_PACKAGE_NAME,d._STANDARD_STUDIES_PACKAGE_NAME,d._PUBLISHED_STUDIES_PACKAGE_NAME,d._CUSTOM_STUDIES_PACKAGE_NAME],r=a.length;r--;)l=a[r],-1!==(h=i.indexOf(l))&&(i.splice(h,1),i.unshift(l));for(u={},p=0,_=0;_<i.length;_++)if(g=i[_],!I||g!==d._FUNDAMENTAL_PACKAGE_NAME){for(f=[],v=d._studies[g],g===d._PUBLISHED_STUDIES_PACKAGE_NAME&&(v=e),r=0;r<v.length;r++)if(y=v[r],n.length)for(S=0;S<n.length;S++)b=n[S].re,b.lastIndex=0,m=n[S].fullMatch,E=y.shortDescription,E&&E.toLowerCase()===t.toLowerCase()?s(f,y,E,3,!0,m):E&&m.test(E)?s(f,y,E,2,!0,m):(E=this._getScriptLocalizedName(y),m.test(E)?s(f,y,E,1,!0,m):b.test(E)&&s(f,y,E,0,!0,b));else f.push(y);if(f=d._applyGlobalFilter(f),f.length){switch(C=g,g){case d._BASIC_STUDIES_PACKAGE_NAME:case d._STANDARD_STUDIES_PACKAGE_NAME:C=d._BASIC_STUDIES_PAGE_NAME;break;case d._CUSTOM_STUDIES_PACKAGE_NAME:C=$.t("My Scripts");break;case d._PUBLISHED_STUDIES_PACKAGE_NAME:C=$.t("Public Library");break;default:g in d._packagesWithTabNames&&(C=d._packagesWithTabNames[C])}C in u||(u[C]=[]),u[C]=u[C].concat(f),p+=f.length}}for(A=this._selectedStudy?this._selectedStudy.data("study"):null,o.html(""),w=Object.keys(u),r=0;r<w.length;++r)if(C=w[r],f=u[C],n.length&&Array.prototype.sort.call(f,function(t,e){if(t.matchPriority<e.matchPriority)return 1;if(t.matchPriority>e.matchPriority)return-1;if(t.matchPriority===e.matchPriority)switch(t.matchIndex){case void 0:return 0;default:return t.matchIndex>e.matchIndex?1:t.matchIndex<e.matchIndex?-1:0}}),P=this._createItemsGroup(f,this._options.minimized?"":$.t(C),n),o.append(P),this._selectedStudy=null,A&&A.pine&&A.pine.version<0)for(T=this.currentPage().find(".js-study-item"),S=0;S<T.length;++S)if(k=$(T[S]),k.data("study").id===A.id){this._selectedStudy=k,this._selectedStudy.addClass("tv-insert-study-item--selected");break}0===p&&o.append('<p class="tv-insert-indicator-dialog__not-found-message">'+$.t("No indicators matched your criteria.")+"</p>")}}.bind(this))),i||this.selectPage("search")},o.prototype.updateSearchPage=function(){var t=this._search_input.val();this.search(t,!0,!0)},o.prototype.updateMarketPages=function(){},o.prototype.preparePageStudies=function(t,e,i,s){var o,n;t&&(s||(e=this.sortStudies(e)),o=this._selectedStudy?this._selectedStudy.data("study"):null,t.empty(),n=this._createItemsList(),this.fillStudies(n,e,null,o&&o.id),t.append(n))},o.prototype.addPage=function(t,e){var i,s,o,n,a,r;return e=$.extend({},e),i=e.localizedTitle||$.t(t),s=t.toLowerCase(),o=$('<div class="tv-insert-indicator-dialog__page">').data("title",s),n=$('<div class="tv-insert-indicator-dialog__tab js-tab"></div>').text(i).data("title",s).attr("title",i),a=e.technical?$.t("Technical Analysis")+": ":"",o.data("fullTitle",a+i),n.toggleClass("tv-insert-indicator-dialog__tab--beta",!!e.beta),
e.packageName&&(this._packagesWithTabNames[e.packageName]=t),this._pages[s]=o,this._tabs[s]=n,e.withoutTopPadding&&o.addClass("tv-insert-indicator-dialog__page--without-top-padding"),e.noFlex&&o.addClass("tv-insert-indicator-dialog__page--no-flex"),e.technical||e.market?(r=e.technical?this._getOrCreateTechnicalTab():this._getOrCreateMarketTab(),r.find(".tv-insert-indicator-dialog__tabs").append(n),e.market&&o.addClass("js-marketplace-page")):this._w_market_tabs?n.insertBefore(this._w_market_tabs):this._w_tabs.append(n),this._w_pages.append(o),o.toggleClass("i-hidden",s!==this._currentPageTitle),o},o.prototype._createGroupTab=function(t,e){var i=$(s.render(P,{title:t}));return i.find(".js-tab-head").on("click",function(){this._expandCollapseTabs(i,e)}.bind(this)),this._expandCollapseTabs(i,e,g.getBool(e,!0),!0),i.data("settings-open-key",e),this._w_tabs.append(i),i},o.prototype._getOrCreateMarketTab=function(){return this._w_market_tabs||(this._w_market_tabs=this._createGroupTab($.t("Marketplace Add-ons"),"studyMarket.marketTabIsOpen"),this._w_market_tabs.addClass("tv-insert-indicator-dialog__tabs-group--marketplace")),this._w_market_tabs},o.prototype._getOrCreateTechnicalTab=function(){return this._w_technical_tabs||(this._w_technical_tabs=this._createGroupTab($.t("Technical Analysis"),"studyMarket.technicalTabIsOpen")),this._w_technical_tabs},o.prototype._onDialogClosed=function(){this._keyDownListener.stopWatching(window),this._shortCutsLockId&&E.enable(this._shortCutsLockId),null!==this._selectedStudy&&this._selectedStudy.removeClass("tv-insert-study-item--selected"),this._selectedStudy=null,this.visibilityChanged.fire(!1),S.removeListener("StudyMarketDialog")},o.prototype.hide=function(){this._dialog.close()},o.prototype.show=function(t){var e,i;this.init(),e=!1,i=t instanceof TradingView.Study&&t||null,i!==this._parentSource&&(this._parentSource=i,this._dialogTitleText=this._parentSource?$.t("Apply Indicator on {0}").format(this._parentSource.title(!0)):a.enabled("study_dialog_fundamentals_economy_addons")?$.t("Indicators & Strategies"):$.t("Indicators"),e=!0),this._updateDialogTitleText(),this._widget.on("keyup.hideDialogStudy",function(t){t.which===b.ESC&&(this._widget.unbind("keyup.hideDialogStudy"),this.hide())}.bind(this)),this._clearInput(),this.loadFavorites(),e&&this.resetAllPages(),this._scroll.scrollTo(0),this.visibilityChanged.fire(!0),this.focusAddSymbolInput(this._currentPageTitle),this._shortCutsLockId=E.disable(),this._keyDownListener.watchOn(window),S.registerListener("StudyMarketDialog",function(t){return!t.ctrlKey&&(47!==t.which&&(!!t.charCode&&(!(!t.which||t.which<=32)&&(!/^(input|textarea)$/i.test(t.target.tagName)&&(t.preventDefault(),!!(TradingView.onWidget()||this._options.minimized&&!a.enabled("study_dialog_search_control"))||(this._search_input.focus(),this._search_input[0].value=String.fromCharCode(t.charCode),!0))))))}.bind(this)),this._dialog.open(),l.emit("indicators_dialog")},o.prototype.isVisible=function(){return!!this._initialized&&this._widget.is(":visible")},
o.prototype.getPage=function(t){return t=t.toLowerCase(),this._pages[t]},o.prototype.focusAddSymbolInput=function(t){t===this._ECONOMY_TAB.toLowerCase()&&this._$economyTabInput&&this._$economyTabInput.focus()},o.prototype._showHideBackButton=function(){if(this._dialog&&!this._options.minimized){var t=""!==this._currentPageTitle;this._dialog.$el.find(".js-title-container").toggleClass("i-with-back-button",t)}},o.prototype.selectPage=function(t){var e,i,s,o,n,a;if(t=t.toLowerCase(),this.focusAddSymbolInput(t),this._currentPageTitle!==t)if(""===t||t in this._pages&&t in this._tabs&&("favorites"!==t||this.hasVisibleFavorites())){for(e in this._pages)if(i=t===e,s=this._pages[e],s.toggleClass("i-hidden",!i),this._tabs[e].toggleClass("i-active",i),i){if(s.trigger("show-page"),o=this._tabs[e].parents(".tv-insert-indicator-dialog__tabs-group"),0===o.length)continue;n=o.find(".js-tab-head"),this._expandCollapseTabs(o,n.data("settings-open-key"),!0,!0)}this._currentPageTitle=t,this._w_pages.scrollTop(0),g.setValue(this._PAGE_KEY,t),this._selectedStudy&&(this._selectedStudy.removeClass("tv-insert-study-item--selected"),this._selectedStudy=null),a=""!==this._currentPageTitle,this._widget.find(".js-tabs-viewport").toggleClass("i-active",!a),this._w_pages.toggleClass("i-active",a),this._showHideBackButton(),a||this._search_input.blur(),this._updateDialogTitleText()}else this.selectPage(this._BASIC_STUDIES_PAGE_NAME)},o.prototype.attachHandlers=function(){var t=Modernizr.touch?"touchend":"click",e=this;Modernizr.touch&&this._w_pages.on("touchstart",".js-study-item",function(t){e._touchStart=$.extend({},t.originalEvent.touches[0])}),this._w_tabs.on("click",".js-tab",this._onTabClicked.bind(this)),a.enabled("items_favoriting")&&this._w_pages.on(t,".js-favorite-icon",this.toggleItem.bind(this)),this._w_pages.on(t,".js-study-item",function(t){var i;e._touchStart&&(i=e._w_pages.find(".tv-insert-study-item")[0].clientHeight,Math.abs(e._touchStart.screenY-t.originalEvent.changedTouches[0].screenY)>i)||(e._selectedStudy&&e._selectedStudy.removeClass("tv-insert-study-item--selected"),e._selectedStudy=$(t.target).closest(".js-study-item"),e._selectedStudy.addClass("tv-insert-study-item--selected"),e.insertThisStudy(e._selectedStudy))})},o.prototype._onTabClicked=function(t){var e=$(t.currentTarget).data("title");e&&"search"!==e&&this.selectPage(e),t.stopPropagation()},o.prototype._expandCollapseTabs=function(t,e,i,s){var o,n=t.hasClass("i-dropped");if(void 0===i)i=!t.hasClass("i-dropped");else if(n===i&&!s)return;if(o=t.find(".tv-insert-indicator-dialog__tabs"),t.toggleClass("i-dropped",!!i),s)return void o.toggleClass("i-hidden",!i);o.removeClass("i-hidden"),o.velocity(i?"slideDown":"slideUp",{duration:_.dur/2,complete:function(){g.setValue(e,i),this._scroll.updateScroll()}.bind(this)})},o.prototype.toggleItem=function(t){var e=$(t.target).closest(".js-study-item").data("study");return this.toggleFavorite(e.id),this.toggleEverywhere(e.id),!1},o.prototype.toggleEverywhere=function(t){var e=this,i=this.isFavorite(t)
;this._w_pages.find(".js-study-item").filter(function(i,s){var o=$(s).data("study");return!!o&&e.favsModel.favId(o.id)===e.favsModel.favId(t)}).find(".js-favorite-icon").toggleClass("i-starred",i).attr("title",this.favTitle(i))},o.prototype.toggleFavorite=function(t){this.favsModel.favorite(t)},o.prototype.isFavorite=function(t){return this.favsModel.isFav(t)},o.prototype._getInviteOnlyStudies=function(){return new Promise(function(t,e){t([])})},o.prototype.resetInvitesOnlyPage=function(){var t=this;t._tabs.invitesonly&&(t._previousInviteOnlyStudiesIds&&0!==t._previousInviteOnlyStudiesIds.length?t._tabs.invitesonly.show():t._tabs.invitesonly.hide()),t._getInviteOnlyStudies().then(function(e){t._previousInviteOnlyStudies=e,t.preparePageStudies(t._pages.invitesonly,e),t._tabs.invitesonly&&(e&&0!==e.length?t._tabs.invitesonly.show():t._tabs.invitesonly.hide())},function(){t.preparePageStudies(t._pages.invitesonly,[]),t._tabs.invitesonly&&t._tabs.invitesonly.hide()})},o.prototype.updateFavorites=function(){var t,e,i,s,n,a,r,l,c,h,u,p,_;if(this._w_pages){if(t=this,e=this.getVisibleFavorites(),i=function(){"favorites"===t._currentPageTitle&&t.selectPage(f.device===o._breakpointDevice?"":t._BASIC_STUDIES_PAGE_NAME),t._w_pages.find(".js-favorite-icon").removeClass("i-starred"),t._tabs&&t._tabs.favorites&&t._tabs.favorites.hide()},t._tabs.favorites&&0===e.length)return void i();for(s=$.Deferred(),n=[],a=[],r=0;r<e.length;r++)if(l=e[r],c=this.getStudyPackageName(l),!I||c!==t._FUNDAMENTAL_PACKAGE_NAME)if(c!==t._PUBLISHED_STUDIES_PACKAGE_NAME){for(h=this._studies[c]||[],u=0;u<h.length;u++)if(p=t.favsModel.favId(d.cutFullId(h[u].id)),_=t.favsModel.favId(l),p===_){n.push(h[u]);break}}else a.push(l);a.length&&!this._options.minimized||s.resolve(n),s.done(function(t){0===t.length?i():this._tabs.favorites.show(),t=this._applyStrategiesFilter(t),this.preparePageStudies(this._pages.favorites,t),this._w_pages.find(".js-study-item").find(".js-favorite-icon").removeClass("i-starred"),e.forEach(this.toggleEverywhere,this)}.bind(this)),n&&0!==n.length&&this._tabs.favorites.show()}},o.prototype.hasVisibleFavorites=function(){return!!this.getVisibleFavorites().length},o.prototype.getVisibleFavorites=function(){return this.checkExcludePackageStudies(this.favsModel.favorites())},o.prototype.checkExcludePackageStudies=function(t){return t.filter(function(t){var e=this.getStudyPackageName(t);return e===this._PUBLISHED_STUDIES_PACKAGE_NAME||!!(this._studies&&this._studies[e]&&$.grep(this._studies[e],function(e){return e.id.indexOf(t)>=0}).length>0)&&(e===this._BASIC_STUDIES_PACKAGE_NAME||e===this._STANDARD_STUDIES_PACKAGE_NAME||e===this._CUSTOM_STUDIES_PACKAGE_NAME||e===this._SCRIPTING_PACKAGE_NAME||e===this._FUNDAMENTAL_PACKAGE_NAME||pro.hasPackage(e)&&e in this._studies)},this)},o.prototype.sortStudies=function(t){return t.sort(function(t,e){return t=t.scriptName||t.description_localized||t.description,e=e.scriptName||e.description_localized||e.description,t>e?1:t<e?-1:0})},o.prototype.fillStudies=function(t,e,i,s){var o;t.empty(),
e.forEach(function(e){e?(o=this.createStudyListItem(e,i),e.id===s&&(this._selectedStudy=o,this._selectedStudy.addClass("tv-insert-study-item--selected"))):(o=document.createElement("div"),o.className="placeholder"),t.append(o)},this)},o.prototype.createStudyListItem=function(t,e){var i,o,n,r,l,c,h,u,p,_,g,f,v,y,S,b,m,E,C,A,w,P,I,k,D,M,O,N=this._getScriptLocalizedName(t),x=this.isFavorite(t.id),U=[];if(e&&N)for(i=[],e instanceof RegExp?i.push({re:e,fuzzyHighlight:!1}):$.isArray(e)&&(i=e),o=0;o<i.length;o++)if(n=i[o].fullMatch,r=i[o].reserveRe,l=i[o].re,n.lastIndex=0,l.lastIndex=0,c=n.exec(N),c?i[o].fuzzyHighlight=!1:(c=l.exec(N),!c&&r&&(c=r.exec(N)),i[o].fuzzyHighlight=!0),c)if(i[o].fuzzyHighlight)for(h=c.index,u=1;u<c.length;u++)p=c[u].length,u%2&&(U[h]=!0),h+=p;else for(_=0;_<c[0].length;_++)U[c.index+_]=!0;return g=TradingView.clean(N,!0),f=g.replace(/./g,function(t,e){if("<"===t?t="&lt;":"&"===t?t="&amp;":'"'===t&&(t="&quot;"),U[e]){if(" "===t||"-"===t||"/"===t)return U[e+1]=!0,t;t='<span class="i-match">'+t+"</span>"}return t}),v=!!t.pine,y=this.getStudyPackageName(t.id),S=v&&y===this._PUBLISHED_STUDIES_PACKAGE_NAME,b=v&&y===this._CUSTOM_STUDIES_PACKAGE_NAME,m=v&&(y===this._STANDARD_STUDIES_PACKAGE_NAME||y===this._FUNDAMENTAL_PACKAGE_NAME),E=v&&[TVScript.Access.ACCESS_CLOSED_NEEDS_AUTH,TVScript.Access.ACCESS_CLOSED_NO_AUTH].indexOf(t.pine.access)>=0,C=v&&TVScript.Access.ACCESS_CLOSED_NEEDS_AUTH===t.pine.access,A=v&&C&&void 0!==t.pine.userHaveAccess,w=v&&t.pine.userHaveAccess,P=!!t.TVScriptSourceCode,I=!1,k=v&&!m&&!E&&(b||S||P||x&&!I),D={closed:$.t("Invite-only script. Contact the author for more information."),open:$.t("Invite-only script. You have been granted access.")},M=$(s.render(T,{publishedOrUserScript:b||S,title:f,titleTooltip:TradingView.strip_tags(g),isStrategy:d.isScriptStrategy(t),isInviteOnly:C,showAccessIcon:A,accessIconClass:w?"tv-insert-study-item__green-lock-icon":"tv-insert-study-item__red-lock-icon",accessTooltip:w?D.open:D.closed,author:t.author&&t.author.username,likes:t.agreeCount?t.agreeCount+" "+$.t("like",{plural:"likes",count:t.agreeCount}):"",showMoreButton:!!t.imageUrl,deleteButton:!t.imageUrl&&b,withFavorites:a.enabled("items_favoriting")&&!this._options.minimized})),k||M.find(".js-show-source-btn").removeClass("js-show-source-btn").addClass("i-empty"),M.data("study",t),void 0!==t.isCustomIndicator&&M.addClass("custom-indicator"),a.enabled("items_favoriting")&&(O=M.find(".js-favorite-icon"),O.toggleClass("i-starred",!!x),O.attr("title",this.favTitle(!!x))),a.enabled("graying_disabled_tools_enabled")&&ChartApiInstance.studiesAccessController.isToolGrayed(t.description)&&M.addClass("i-grayed"),M},o.prototype.favTitle=function(t){return t?$.t("Remove from favorites"):$.t("Add to favorites")},o.prototype.insertThisStudy=function(t){if(!t.hasClass("placeholder")){var e=t.data("study");return a.enabled("graying_disabled_tools_enabled")&&ChartApiInstance.studiesAccessController.isToolGrayed(e.description)?void l.emit("onGrayedObjectClicked",{type:"study",name:e.description
}):(t.highlight(this.HIGHLIGHT_STUDY_NUM_FLICKS),this.insertStudy(e),!1)}},o.prototype.insertStudy=function(t){var e,i,s=this,o=s._chartWidgetCollection.activeChartWidget.value();o&&(e=o.insertStudyStub(t.description),i=d.replaceWithFullStudyMetaInfoAsync(o.model().studiesMetaData(),t),i.done(function(t){if(o.removeStudyStub(e.id())){if(this._parentSource&&!d.canBeChild(t))return void u({type:"modal",title:$.t("Oops!"),content:$.t("This indicator cannot be applied to another indicator")});o.insertStudyOrShowDialog(t,this._parentSource,function(){s._dialog.focus()}),this._is_on_chart=!0}}.bind(this)),i.fail(function(t){A.logError("Error: "+t),e.setStatus(t)}))},o.prototype.onLoginStateChange=function(t){t||this.setUser(window.user),PublishedScript.cleanCache(),this.resetAllPages(),this.setup(),this.init()},o.prototype.getStudyList=function(t){function e(t){i.push(t)}var i,s;if(!this.studiesReady.isResolved())return[];i=[];for(s in this._studies)(s===this._BASIC_STUDIES_PACKAGE_NAME||pro.hasPackage(s))&&(this._studies[s].forEach(e),t&&i.push({separator:!0}));return t&&i.splice(i.length-1,1),i},o.prototype.getStudyPackageName=function(t){var e,i,s,o,n,a;if(t)return e=t.split("@"),(i=1===e.length)||(s=d.getPackageName(t))===this._SCRIPTING_PACKAGE_NAME?(o=e[0],i||/^(Strategy)?Script\$/.test(o)?(n=o.indexOf("_"),-1!==n?(s=o.substring(0,n),a=s.indexOf("Script$")>=0?s:"Script$"+s,pro.getSuperProduct(a)||a):/USER;/.test(o)?this._CUSTOM_STUDIES_PACKAGE_NAME:/PUB;/.test(o)?this._PUBLISHED_STUDIES_PACKAGE_NAME:/STD;/.test(o)?this._STANDARD_STUDIES_PACKAGE_NAME:o):s):s},o.prototype.selectSearchPage=function(){this.selectPage("search"),this._clearInput()},o.prototype._insertStudyByShortDescription=function(){var t,e,i,s=this._search_value;for(s=s.trim(),t=this._studies[this._BASIC_STUDIES_PACKAGE_NAME],e=0;e<t.length;e++)if(i=t[e],i.shortDescription&&i.shortDescription.toUpperCase()===s.toUpperCase()){this.insertStudy(i);break}},o.prototype._clearInput=function(){this._search_input.val(""),"search"===this._currentPageTitle&&this._search_input.val("").trigger("input").focus()},o.prototype._getScriptType=function(){return 0},o.prototype._getScriptLocalizedName=function(t){return t.description_localized||$.t(t.scriptName||t.description||" ",{context:"study"})},o.prototype._pubSearchEntryAlreadyLoaded=function(t){var e=t.scriptIdPart.split(";")[1];return!(this._pubSearchCache.indexOf(e)<0)||(this._pubSearchCache.push(e),!1)},o.prototype._addPubSearchResult=function(t,e){t.length&&(t.forEach(function(t){this._pubSearchEntryAlreadyLoaded(t)||(this._pubSearchEntries.push(t),this._pubSearchCount[t.scriptType]++)},this),0===e&&(this._pubSearchCount[0]+=t.length),this._pubSearchEntries.sort(function(t,e){return e.agreeCount-t.agreeCount}))},o.prototype._getPublicLibraryRequestParams=function(t){var e=this._pubSearchCount[t],i=this._PUB_SEARCH_ENTRIES_ON_PAGE;return e<this._PUB_SEARCH_ENTRIES_ON_PAGE&&(i=this._PUB_SEARCH_ENTRIES_ON_PAGE-e),{offset:e,count:i,type:t}},t.exports.StudyMarketDialog=o}).call(e,i(8),i(93))},955:function(t,e,i){
"use strict";var s;Object.defineProperty(e,"__esModule",{value:!0}),s=i(956),i.n(s),i.o(s,"TVPopup")&&i.d(e,"TVPopup",function(){return s.TVPopup})},956:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function o(t){var e,i;if(t&&t.__esModule)return t;if(e={},null!=t)for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var l,c,d,h,u,p,_,g,f,v,y,S,b;Object.defineProperty(e,"__esModule",{value:!0}),e.TVPopup=void 0,l=Object.assign||function(t){var e,i,s;for(e=1;e<arguments.length;e++){i=arguments[e];for(s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},c=function(){function t(t,e){var i,s;for(i=0;i<e.length;i++)s=e[i],s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),d=i(77),h=o(d),u=i(220),p=s(u),_=i(221),g=i(147),f=i(219),v=$("body"),y=$(window),S={closeOnClickAtOtherDialogs:!0,draggable:!0,scrollWrap:'<div class="tv-dialog__scroll-wrap">',scrollWrapInner:'<div class="tv-dialog__scroll-wrap-inner">',withScroll:!0},b="js-dialog__scroll-wrap",e.TVPopup=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n(this,e),t=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,l({},S,i))),t.$scrollWrap=t.$content.hasClass(b)?t.$content:t.$content.find("."+b),t.$scrollWrap.length?t.$scrollWrapInner=t.$scrollWrap.children().first():(t.$scrollWrap=t.$content.wrap($(t.options.scrollWrap)).parent(),t.$scrollWrapInner=t.$content.wrap($(t.options.scrollWrapInner)).parent()),t.$actions&&t.$scrollWrap.addClass("i-with-actions"),t.options.withScroll&&(t.scroll=new g.SidebarCustomScroll(t.$scrollWrap,t.$scrollWrapInner),t.scroll.scrolled.subscribe(null,function(){return t.trigger("scroll")})),t.$scrollWrap.css("overflow",""),t.$el.addClass("tv-dialog--popup i-closed i-hidden"),t.options.width&&t.$el.css({width:"calc(100% - 20px)","max-width":t.options.width}),t.$el.on("mousedown touchstart",t.toTop.bind(t)),t.options.closeOnOutsideClick&&(t.on("beforeOpen",function(){setTimeout(function(){t.opened&&$(document).on("click.tv-popup-"+t.id,function(e){var i=$(e.target).closest(".js-dialog");(t.options.closeOnClickAtOtherDialogs||0===i.length)&&t.isEventOut(e)&&t.close()})},0)}),t.on("beforeClose",function(){return $(document).off("click.tv-popup-"+t.id)})),t.on("change:zIndex",function(){t.$el.css("z-index",t.zIndex)}),
t.on("destroy",function(){var e=function(){t.$el.remove()};t.opened?(t.close(),setTimeout(e,h.dur/2)):e()}),t}return r(e,t),c(e,[{key:"open",value:function(){var t=this;return this.opened?this:(this.opened=!0,this.trigger("beforeOpen",[this]),this.$el.appendTo(this.options.$wrap).removeClass("i-hidden").css(function(){var e,i,s,o,n;return t.calcHeight(),e=y.height(),i=y.width(),s=t.$el.height(),o=t.$el.width(),n=t.options.position,n||(n={top:e/2-s/2,left:i/2-o/2}),n.top>e-s&&(n.top=e-s),n.left>i-o&&(n.left=i-o),n}()),this.focus(),this.toTop(),this._doOpenAnimation().then(function(){t.opened&&(t.$el.removeClass("i-closed"),t.options.draggable&&((0,f.lazyJqueryUI)(t.$el).draggable({handle:".js-dialog__drag",cancel:"input, textarea, button, select, option, .js-dialog__no-drag, .js-dialog__close",containment:"window",cursor:"-webkit-grabbing"}),t.$el.find(".js-dialog__drag").addClass("tv-dialog__grab")),t.trigger("afterOpen",[t]))}),y.on("resize.tv-popup-"+this.id,function(){t.calcHeight(),t.fixPos()}),this)}},{key:"close",value:function(){var t=this;if(this.opened)return this.trigger("beforeClose",[this]),this.$el.addClass("i-closed"),this.opened=!1,this._doCloseAnimation().then(function(){t.opened||((0,f.lazyJqueryUI)(t.$el).draggable("instance").then(function(t){t&&t.destroy()}),t.$el.addClass("i-hidden").detach(),v.css("cursor","auto"),t.trigger("afterClose",[t]),t.options.destroyOnClose&&t.destroy())}),y.off("resize.tv-popup-"+this.id),this}},{key:"hide",value:function(){this.$el.addClass("i-hidden")}},{key:"show",value:function(){this.$el.removeClass("i-hidden")}},{key:"fixPos",value:function(){var t=this.$el[0].getBoundingClientRect(),e={};t.bottom>p.default.height-10&&(e.top=p.default.height-10-t.height,e.top<10&&(e.top=10)),t.right>p.default.width-10&&(e.left=p.default.width-10-t.width,e.left<10&&(e.left=10)),(e.top||e.left)&&this.$el.css(e)}},{key:"calcHeight",value:function(){var t,e,i=this.$el[0].getBoundingClientRect(),s=this.$scrollWrapInner[0].getBoundingClientRect(),o=this.$scrollWrap[0].getBoundingClientRect(),n=this.options.height&&this.options.height<p.default.height-20?this.options.height:p.default.height-20;this.$scrollWrap.css({height:""}).removeClass("i-scrollable"),t=this.$el[0].getBoundingClientRect(),(this.options.height||t.height>n)&&(n-=i.height-o.height,n<60&&(n=60),this.$scrollWrap.css({height:n})),this.options.withScroll&&this.scroll.resize(),e=n<s.height,e||this.$scrollWrapInner.css("top",0),this.$scrollWrap.toggleClass("i-scrollable",e),this.$actions&&this.$actions.toggleClass("tv-dialog__section--actions_with-border",e)}},{key:"updateScroll",value:function(){this.scroll&&(this.scroll.updateScroll(),this.scroll.updateScrollBar())}},{key:"scrollToStart",value:function(){this.scroll&&this.scroll.scrollToStart()}},{key:"_doOpenAnimation",value:function(){return Promise.resolve()}},{key:"_doCloseAnimation",value:function(){return Promise.resolve()}}]),e}(_.TVDialogAbstract)},967:function(t,e){
t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M8.5 1.5L3.5 7l5 5.5"/></svg>'},972:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14"><path fill-rule="evenodd" d="M10.893 9.512l.458 3.624c.014.105-.006.16-.02.176-.028.03-.109.005-.182-.03L7.812 11.73a1.973 1.973 0 0 0-.811-.16c-.302 0-.59.057-.81.16l-3.338 1.552c-.118.056-.164.051-.182.03-.014-.016-.034-.07-.02-.178L3.11 9.51c.06-.503-.162-1.18-.505-1.54L.087 5.302c-.085-.091-.09-.148-.086-.158.003-.01.04-.053.16-.077l3.621-.689c.491-.09 1.069-.506 1.315-.948L7.004 0l1.902 3.43c.246.442.824.859 1.312.947l3.617.69c.123.024.162.068.164.077.003.01-.003.066-.089.157L11.4 7.97c-.348.367-.57 1.045-.506 1.543z"/></svg>'},973:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" width="14" height="14"><path d="M9.901 9.639c-.102-.797.218-1.775.77-2.356l1.438-1.527-2.07-.395c-.784-.142-1.615-.742-2.008-1.446L7.003 2.06 5.97 3.917c-.391.702-1.222 1.301-2 1.443l-2.08.396 1.44 1.526c.547.577.866 1.549.77 2.353l-.262 2.086 1.93-.897a2.95 2.95 0 0 1 1.233-.254c.44 0 .87.085 1.233.254l1.93.897-.263-2.082zm.992-.127l.458 3.624c.014.105-.006.16-.02.176-.028.03-.109.005-.182-.03L7.812 11.73a1.973 1.973 0 0 0-.811-.16c-.302 0-.59.057-.81.16l-3.338 1.552c-.118.056-.164.051-.182.03-.014-.016-.034-.07-.02-.178L3.11 9.51c.06-.503-.162-1.18-.505-1.54L.087 5.302c-.085-.091-.09-.148-.086-.158.003-.01.04-.053.16-.077l3.621-.689c.491-.09 1.069-.506 1.315-.948L7.004 0l1.902 3.43c.246.442.824.859 1.312.947l3.617.69c.123.024.162.068.164.077.003.01-.003.066-.089.157L11.4 7.97c-.348.367-.57 1.045-.506 1.543z"/></svg>'},981:function(t,e){}});