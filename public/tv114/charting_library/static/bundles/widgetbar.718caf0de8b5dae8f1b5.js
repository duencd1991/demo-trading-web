webpackJsonp([14],{1106:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 17" width="17" height="17"><path fill="none" stroke="currentColor" d="M1 1l15 15M1 16L16 1"/></svg>'},1124:function(t,e,i){"use strict";var n,s,a,o,r,d,l,h,c,g,u;i.d(e,"a",function(){return u}),n=i(0),s=i(19),i.n(s),a=i(67),i.n(a),o=i(115),i.n(o),r=i(365),i.n(r),d=i(359),l=i(227),h=i(1125),i.n(h),c=i(77),g=i(989),i.n(g),u=function(t){function e(e){var i=t.call(this,e)||this;return i._scroll=null,i._handleScrollTop=function(){i.animateTo(Math.max(0,i.currentPosition()-(i.state.heightWrap-50)))},i._handleScrollBot=function(){i.animateTo(Math.min((i.state.heightContent||0)-(i.state.heightWrap||0),i.currentPosition()+(i.state.heightWrap-50)))},i._handleResizeWrap=function(t){var e=t.height;i.setState({heightWrap:e})},i._handleResizeContent=function(t){var e=t.height;i.setState({heightContent:e})},i._handleScroll=function(){var t=i.props.onScroll;t&&t(i.currentPosition(),i.isAtTop(),i.isAtBot()),i._checkButtonsVisibility()},i._checkButtonsVisibility=function(){var t,e,n,s,a;(i.props.isVisibleButtons||i.props.isVisibleFade)&&(t=i.state,e=t.isVisibleTopButton,n=t.isVisibleBotButton,s=i.isAtTop(),a=i.isAtBot(),s||e?s&&e&&i.setState({isVisibleTopButton:!1}):i.setState({isVisibleTopButton:!0}),a||n?a&&n&&i.setState({isVisibleBotButton:!1}):i.setState({isVisibleBotButton:!0}))},i.state={heightContent:0,heightWrap:0,isVisibleBotButton:!1,isVisibleTopButton:!1},i}return n.c(e,t),e.prototype.componentDidMount=function(){this._checkButtonsVisibility()},e.prototype.componentDidUpdate=function(t,e){e.heightWrap===this.state.heightWrap&&e.heightContent===this.state.heightContent||this._handleScroll()},e.prototype.currentPosition=function(){return this._scroll?this._scroll.scrollTop:0},e.prototype.isAtTop=function(){return this.currentPosition()<=1},e.prototype.isAtBot=function(){return this.currentPosition()+this.state.heightWrap>=this.state.heightContent-1},e.prototype.animateTo=function(t,e){if(void 0===e&&(e=c.dur),this._scroll){var i=a.findDOMNode(this._scroll);Object(l.doAnimate)({onStep:function(t,e){i.scrollTop=e},from:i.scrollTop,to:Math.round(t),easing:c.easingFunc.easeInOutCubic,duration:e})}},e.prototype.render=function(){var t,e,i,n,a,l=this,c=this.props,u=c.children,p=c.isVisibleScrollbar,w=c.isVisibleFade,m=c.isVisibleButtons,f=this.state,y=f.heightContent,v=f.heightWrap,b=f.isVisibleBotButton,B=f.isVisibleTopButton;return s.createElement(r,{whitelist:["height"],onMeasure:this._handleResizeWrap},s.createElement("div",{className:h.wrap},s.createElement("div",{className:o(h.scrollWrap,(t={},t[h.noScrollBar]=!p,t)),onScroll:this._handleScroll,ref:function(t){return l._scroll=t}},s.createElement(r,{onMeasure:this._handleResizeContent,whitelist:["height"]},s.createElement("div",{className:h.content},u))),w&&s.createElement("div",{className:o(h.fadeTop,(e={},e[h.isVisible]=B&&y>v,e))}),w&&s.createElement("div",{className:o(h.fadeBot,(i={},i[h.isVisible]=b&&y>v,i))}),m&&s.createElement("div",{className:o(h.scrollTop,(n={},
n[h.isVisible]=B&&y>v,n)),onClick:this._handleScrollTop},s.createElement("div",{className:h.iconWrap},s.createElement(d.a,{icon:g,className:h.icon}))),m&&s.createElement("div",{className:o(h.scrollBot,(a={},a[h.isVisible]=b&&y>v,a)),onClick:this._handleScrollBot},s.createElement("div",{className:h.iconWrap},s.createElement(d.a,{icon:g,className:h.icon})))))},e.defaultProps={isVisibleScrollbar:!0},e}(s.PureComponent)},1125:function(t,e){t.exports={wrap:"wrap-1h7U5nKd-",scrollWrap:"scrollWrap-3gtPS0Fe-",noScrollBar:"noScrollBar-ieMwbfur-",content:"content-YhoA_L2m-",icon:"icon-2xObs8DI-",scrollBot:"scrollBot-2HHpZNuf-",scrollTop:"scrollTop-1eXi8ltS-",isVisible:"isVisible-3zZOL3TO-",iconWrap:"iconWrap-2Q69rfEO-",fadeBot:"fadeBot-3JstnoWq-",fadeTop:"fadeTop-3oJzNyTq-"}},1128:function(t,e,i){"use strict";function n(t){return s.createElement("svg",{xmlns:r,width:"9",height:"27",viewBox:"0 0 9 27",className:a(o.container,"right"===t.direction?o.mirror:null)},s.createElement("g",{fill:"none",fillRule:"evenodd"},s.createElement("path",{className:o.background,d:"M4.5.5a4 4 0 0 1 4 4v18a4 4 0 1 1-8 0v-18a4 4 0 0 1 4-4z"}),s.createElement("path",{className:o.arrow,d:"M5.5 10l-2 3.5 2 3.5"})))}var s,a,o,r;e.a=n,s=i(19),i.n(s),a=i(115),i.n(a),o=i(1129),i.n(o),r="http://www.w3.org/2000/svg"},1129:function(t,e){t.exports={container:"container-3_8ayT2Q-",mirror:"mirror-crJbq8d0-",background:"background-Q1Fcmxly-",arrow:"arrow-WcYWFXUn-"}},1298:function(t,e,i){"use strict";function n(t){return g.filter(function(e){return e.m===t})[0]}function s(t){var e=n(t);e&&e.cb&&$.when(e.cb()).done(function(){e.state="loaded",e.args=Array.prototype.slice.call(arguments),delete e.cb,a(e.m)})}function a(t){var e=n(t),i=function t(i){i&&!i.length||(i.shift().apply(null,e.args),t(i))},s=u[t];s&&i(s)}function o(t,e){"number"==typeof e?setTimeout(function(){return s(t)},e):!0===e&&s(t)}function r(t){return!!n(t)}function d(t,e,i){if(e){var s=n(t);s?s.cb=e:g.push({m:t,cb:e})}(void 0!==i||p)&&o(t,i)}function l(t){var e=n(t);return e&&"loaded"===e.state}function h(t,e){var i=n(t);u[t]=u[t]||[],u[t].push(e),i&&"loaded"===i.state&&a(t)}var c,g,u,p;Object.defineProperty(e,"__esModule",{value:!0}),e.isExists=r,e.load=d,e.isLoaded=l,e.onReady=h,c=5e3,g=[],u={},p=!1,setTimeout(function(){var t;for(p=!0,t=0;t<g.length;t+=1)s(g[t].m)},c)},1299:function(t,e,i){"use strict";var n,s,a;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"WidgetBarInternal",function(){return a}),n=i(4),i.n(n),s=i(6),i.n(s),a=function(){function t(t){var e,i=this;this._handleDomPanelMinimizedChange=function(t){Object(s.ensure)(i._widgetBar.domPanel).trading.domVisibility.setValue(!t)},this._widgetBar=t,this.isDomButtonAvailable()&&(e=Object(s.ensure)(this._widgetBar.domPanel),e.minimized.subscribe(this._handleDomPanelMinimizedChange))}return t.prototype.destroy=function(){if(this.isDomButtonAvailable()){Object(s.ensure)(this._widgetBar.domPanel).minimized.unsubscribe(this._handleDomPanelMinimizedChange)}},t.prototype.isHelpButtonAvailable=function(){return!n.enabled("widget")},
t.prototype.isBugReportButtonAvailable=function(){return!n.enabled("widget")},t.prototype.isDomButtonAvailable=function(){return!n.enabled("widget")&&!!this._widgetBar.domPanel},t}()},1300:function(t,e,i){"use strict";function n(t){var e=u(t.className,w.button,t.isGrayed&&w.isGrayed);return d.createElement("div",{className:e,onClick:t.onClick,"data-role":"button","data-name":t.name},d.createElement(p.a,{className:w.icon,icon:m}))}function s(t){t=c.a({isTab:!0},t);var e=u(t.className,v.button,t.isTab&&v.isTab,t.isActive&&v.isActive,t.isGrayed&&v.isGrayed,t.hint&&"apply-common-tooltip common-tooltip-vertical");return d.createElement("div",{className:e,title:t.hint,onClick:t.onClick,"data-role":"button","data-name":t.name},d.createElement("div",{className:v.hoverMask},d.createElement(p.a,{icon:t.icon}),d.createElement("div",{className:v.counterRow},d.createElement("span",{className:v.counter,"data-name":"counter"},t.count))))}function a(t){return d.createElement("div",{className:W.separator})}function o(t){return d.createElement("div",{className:u(C.filler,t.className)})}function r(t,e){return function(i){function n(t){var n=i.call(this,t)||this;return n._bindedForceUpdate=function(){return n.forceUpdate()},n.state={viewModel:e},n}return c.c(n,i),n.prototype.componentDidMount=function(){var t=this.state.viewModel;t.notificationsCount.subscribe(this._bindedForceUpdate),t.isActive.subscribe(this._bindedForceUpdate)},n.prototype.componentWillUnmount=function(){var t=this.state.viewModel;t.notificationsCount.unsubscribe(this._bindedForceUpdate),t.isActive.unsubscribe(this._bindedForceUpdate)},n.prototype.render=function(){var e=this.state.viewModel,i=e.notificationsCount.value();return d.createElement(t,c.a({},this.props,{icon:e.icon.value(),isActive:e.isActive.value(),onClick:e.onClick.value(),hint:e.hint.value(),count:0!==i?""+i:void 0}))},n}(d.PureComponent)}var d,l,h,c,g,u,p,w,m,f,y,v,b,B,_,W,C,P,$,M,T;Object.defineProperty(e,"__esModule",{value:!0}),d=i(19),l=i(67),h=i(146),c=i(0),g=i(117),u=i(115),p=i(359),w=i(1301),m=i(1106),f=i(1124),y=i(6),v=i(1302),b=i(1303),B=window.t("DOM"),_=function(t){function e(e,i){var n,s,a=t.call(this,e,i)||this;return a._handleClick=function(){var t=a.context.widgetBar,e=Object(y.ensure)(t.domPanel);e.minimized.setValue(!e.minimized.value())},a._handlePanelMinimizedChange=function(t){a.setState({isActive:!t})},n=a.context.widgetBar,s=Object(y.ensure)(n.domPanel),a.state={isActive:!s.minimized.value()},a}return c.c(e,t),e.prototype.componentDidMount=function(){var t=this.context.widgetBar;Object(y.ensure)(t.domPanel).minimized.subscribe(this._handlePanelMinimizedChange)},e.prototype.componentWillUnmount=function(){var t=this.context.widgetBar;Object(y.ensure)(t.domPanel).minimized.unsubscribe(this._handlePanelMinimizedChange)},e.prototype.render=function(){return d.createElement(s,c.a({},this.props,{icon:b,hint:B,isActive:this.state.isActive,onClick:this._handleClick}))},e.contextTypes={widgetBar:g.object.isRequired},e}(d.PureComponent),W=i(1304),C=i(1305),P=i(1306),$=function(t){
function e(e,i){var n,a=t.call(this,e,i)||this;return a._pages={},a._isDomPanelCanBeShown=null,a._isDomPanelMinimized=null,a._handleFullscreenChange=function(t){a.setState({isFullscreen:t})},a._handleCloseClick=function(){a.context.widgetBar.layout.setMinimizedState(!0)},a._handleGrayedChange=function(){a.setState({isGrayed:a._isGrayed()})},a._handleDomButtonVisibilityChange=function(t){a.setState({isDomButtonVisible:t})},a._isGrayed=function(){var t=a._isMinimized.value();return null!==a._isDomPanelMinimized&&(t=t&&a._isDomPanelMinimized.value()),!t},n=a.context.widgetBar,a._isMinimized=n.layout.isMinimized.spawn(),a._isFullscreen=n.resizerBridge.fullscreen.spawn(),a.state={isGrayed:a._isGrayed(),isFullscreen:a._isFullscreen.value(),isDomButtonVisible:!1},n.domPanel&&(a._isDomPanelCanBeShown=n.domPanel.canBeShown.spawn(),a._isDomPanelMinimized=n.domPanel.minimized.spawn(),a.state=c.a({},a.state,{isDomButtonVisible:a._isDomPanelCanBeShown.value()})),n.layout.pages.forEach(function(t){a._pages[t.name]=r(s,t.tab)}),a._toolset=a._createToolset(),a}return c.c(e,t),e.prototype.componentDidMount=function(){this._isFullscreen.subscribe(this._handleFullscreenChange),this._isMinimized.subscribe(this._handleGrayedChange),null!==this._isDomPanelMinimized&&this._isDomPanelMinimized.subscribe(this._handleGrayedChange),null!==this._isDomPanelCanBeShown&&this._isDomPanelCanBeShown.subscribe(this._handleDomButtonVisibilityChange)},e.prototype.componentWillUnmount=function(){this._isFullscreen.destroy(),this._isMinimized.destroy(),null!==this._isDomPanelMinimized&&this._isDomPanelMinimized.destroy(),null!==this._isDomPanelCanBeShown&&this._isDomPanelCanBeShown.destroy()},e.prototype.render=function(){var t=this.props,e=t.className,i=t.isDomButtonAvailable,s=this.state,r=s.isGrayed,l=s.isFullscreen,h=s.isDomButtonVisible,c=this.context.widgetBar,g=this._toolset;return d.createElement(f.a,{isVisibleFade:Modernizr.touch,isVisibleButtons:!Modernizr.touch,isVisibleScrollbar:!1},d.createElement("div",{className:u(e,P.toolbar,r&&P.isGrayed),"data-name":"right-toolbar"},c.adaptive&&l&&d.createElement(n,{name:"close-button",onClick:this._handleCloseClick}),this._renderPages(),i&&h&&d.createElement(d.Fragment,null,d.createElement(a,null),d.createElement(_,{name:"dom-button",isGrayed:r})),d.createElement(o,null),g.BugReportButton&&d.createElement(g.BugReportButton,{name:"bug-report-button",isGrayed:r,isTab:!1}),g.HelpButton&&d.createElement(g.HelpButton,{name:"help-button",isGrayed:r,isTab:!1})))},e.prototype._renderPages=function(){var t=this,e=[],i=this.state.isGrayed;return this.context.widgetBar.layout.pages.forEach(function(n){if(n.name in t._pages){var s=t._pages[n.name];e.push(d.createElement(s,{name:n.name,isGrayed:i,key:n.name})),n.spaceBottom&&e.push(d.createElement(a,{key:n.spaceBottomText}))}}),e},e.prototype._createToolset=function(){var t=this.context.widgetBar;return{BugReportButton:this.props.isBugReportButtonAvailable?r(s,t.ensureBugReportButtonViewModel()):void 0,
HelpButton:this.props.isHelpButtonAvailable?r(s,t.ensureHelpButtonViewModel()):void 0}},e.contextTypes={widgetBar:g.object.isRequired},e}(d.PureComponent),M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c.c(e,t),e.prototype.getChildContext=function(){return{widgetBar:this.props.widgetBar}},e.prototype.render=function(){return this.props.children},e.childContextTypes={widgetBar:g.object},e}(d.PureComponent),i.d(e,"RightToolbarRenderer",function(){return T}),T=function(){function t(t,e){this._container=t,l.render(d.createElement(M,{widgetBar:e.widgetBar},d.createElement($,{isDomButtonAvailable:e.isDomButtonAvailable,isHelpButtonAvailable:e.isHelpButtonAvailable,isBugReportButtonAvailable:e.isBugReportButtonAvailable})),this._container)}return t.prototype.destroy=function(){l.unmountComponentAtNode(this._container)},t}()},1301:function(t,e){t.exports={button:"button-ef8Q4JWf-",icon:"icon-1i5UojWG-"}},1302:function(t,e){t.exports={button:"button-3SuA46Ww-",hovered:"hovered-1QPWdqlG-",icon:"icon-ogPAaQZH-",counterRow:"counterRow-S6Ya-jCg-",counter:"counter-1TX_xqdT-",hoverMask:"hoverMask-LMMGveQV-",isGrayed:"isGrayed-3O5VgbN4-",isActive:"isActive-1D4aU96I-",isTab:"isTab-1dbyVeUX-"}},1303:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m17 30a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2m6 5a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m10 5a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2"/></svg>'},1304:function(t,e){t.exports={separator:"separator-3EpY15lj-"}},1305:function(t,e){t.exports={filler:"filler-3UAoz6aE-"}},1306:function(t,e){t.exports={toolbar:"toolbar-1A0PjTA7-",isGrayed:"isGrayed-1AzrEXYM-"}},1307:function(t,e,i){"use strict";var n,s,a,o,r;Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"WidgetBarTabButtonViewModel",function(){return r}),n=i(0),s=i(15),a=i.n(s),o={isActive:!1,notificationCount:0},r=function(){function t(t){var e=n.a({},o,t);this.isActive=new a.a(e.isActive),this.notificationsCount=new a.a(e.notificationCount),this.icon=new a.a(e.icon),this.hint=new a.a(e.hint),this.onClick=new a.a(e.onClick)}return t.prototype.onActiveStateChange=function(t){this.isActive.setValue(t)},t.prototype.updateNotifications=function(t){this.notificationsCount.setValue(t)},t}()},1308:function(t,e,i){"use strict";function n(t){var e=a(t.className,"apply-common-tooltip","common-tooltip-vertical","common-tooltip-otl");return s.createElement("div",{className:e,onClick:t.onClick,title:t.isMinimized?d:r},s.createElement(o.a,{direction:t.isMinimized?"left":"right"}))}var s,a,o,r,d;Object.defineProperty(e,"__esModule",{value:!0}),e.Hider=n,i(9),
s=i(19),i.n(s),a=i(115),i.n(a),o=i(1128),r=window.t("Hide Tab"),d=window.t("Open Tab")},1309:function(t,e){},1310:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><g fill="none" stroke="currentColor"><path d="M14.5 27.5c0 4.97 3.03 8 8 8 4.97 0 8-3.03 8-8v-6a3 3 0 0 0-3-3h-10a3 3 0 0 0-3 3v6z"/><path stroke-linecap="square" d="M22.5 19v16"/><path d="M27.5 18.5a5 5 0 1 0-10 0m13 3h2a2 2 0 0 1 2 2V25m-4 2.5h2a2 2 0 0 1 2 2V31M29 32.5h1.5a2 2 0 0 1 2 2V36m-18-14.5h-2a2 2 0 0 0-2 2V25m4 2.5h-2a2 2 0 0 0-2 2V31m5.5 1.5h-1.5a2 2 0 0 0-2 2V36"/><g transform="translate(12 8)"><circle cx="2.5" cy="2.5" r="2"/><path d="M3.911 3.911L7 7"/></g><g transform="translate(26 8)"><circle cx="4.5" cy="2.5" r="2"/><path d="M3.115 3.885L0 7"/></g></g></svg>'},1311:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m18 18v-.5c0-1.2.6-2 1.5-2.7.8-.5 2-.8 3-.8s2.2.3 3 .8c.9.6 1.5 1.5 1.5 2.7a4 4 0 0 1-1.3 2.8l-2.3 2c-.3.3-.4.6-.4 1.2v.5h-1v-.5c0-.8.2-1.4.6-1.9l2.4-2c.6-.7 1-1.3 1-2.1a2 2 0 0 0-1-1.8c-.7-.5-1.6-.7-2.5-.7-1 0-1.8.2-2.5.7-.6.4-1 1-1 1.8v.5m3.5 8a1 1 0 0 0 0 5 1 1 0 0 0 0-5m0 1a1 1 0 0 1 0 3 1 1 0 0 1 0-3m0-17a1 1 0 0 0 0 25 1 1 0 0 0 0-25m0 1a1 1 0 0 1 0 23 1 1 0 0 1 0-23"/></svg>'},827:function(t,e,i){"use strict";(function(e,n,s){function a(t,e){e=e||o.widgetConfig;var i=(e[t]||0).title;return!i&&t&&(i=(""+t).match(/[A-Z]{2,}|\d+(?:\.\d+)?|[A-Z]?[a-z]+/g).join(" ").replace(/^.|\s./g,function(t){return t.toUpperCase()})),i||void 0}function o(t){t||(t={}),this.options=t,this.resizerBridge=t.resizerBridge,this.adaptive=!!t.adaptive,this.domPanel=t.domPanel,this.widgetConfig=$.extend(!0,{},o.widgetConfig),t.widgetConfig&&(this.widgetConfig=$.extend(!0,this.widgetConfig,t.widgetConfig)),this.layout=new r({widgetBar:this}),this._customization=t.customization,t.chartWidgetCollection&&(this.chartWidgetCollection=t.chartWidgetCollection),t.state?this.layout.demarshal(t.state):t.settingsPrefix&&(this._settingsPrefix=t.settingsPrefix+"",this.loadFromTVSettings()),t.readonly&&(this.readonly=!0),t.fixedMode&&(this.fixedMode=!0),t.showCloseButton&&(this.showCloseButton=!0),this.$container=$(this.resizerBridge.body.value()),this._internal=new b(this),this.createHTML(),this.initLayout(),loginStateChange.subscribe(this,this.onLoginStateChange),this.resizerBridge.width.subscribe(function(){this.layout.syncWidth()}.bind(this)),this.resizerBridge.height.subscribe(function(){this.layout.syncHeight()}.bind(this)),this.resizerBridge.visible.subscribe(function(t){this.layout.onVisibilityChange(t)}.bind(this)),this.resizerBridge.availWidth.subscribe(function(){this.layout.requestOptimalWidth(),this.layout.updateResponsiveness()}.bind(this))}function r(t){this.widgetBar=t.widgetBar,this.pages=[],this.activePageIndex=new n(this.activeIndex),this.isMinimized=new n(this.minimized),t&&t.widgetBar&&Object.defineProperty(this,"widgetBar",{value:t.widgetBar,configurable:!0})}function d(t){this.widgets=[],
t&&t.widgetBarLayout&&Object.defineProperty(this,"widgetBarLayout",{value:t.widgetBarLayout,configurable:!0})}function l(t){t&&t.widgetBarPage&&Object.defineProperty(this,"widgetBarPage",{value:t.widgetBarPage,configurable:!0}),this._internalState={alive:new n(!0),body:new n,width:new n,height:new n,detachable:new n(!1)},this._rdState=new M.ResizerDetacherState(this._internalState),this._rdState.owner.subscribe(function(t){t!==this._internalState&&this._internalState.body.value().empty()}.bind(this)),this.widgetActive=new n,this.widgetMaximized=new n,this._widgetStarted=new s}function h(t){t&&t.settingsKey&&(this._settingsKey=t.settingsKey,this._value=TVSettings.getJSON(this._settingsKey,null)),t&&t.widgetBarWidget&&Object.defineProperty(this,"widgetBarWidget",{value:t.widgetBarWidget,configurable:!0})}var c,g,u,p,w,m,f,y,v,b,B,_,W,C,P,M;i(97),c="widgetbar",g=i(1298),u=i(407),p=i(56).linking,w=i(220),m=i(28).trackEvent,f=i(95).isFeatureEnabled,y=i(22),v=i(406),b=i(1299).WidgetBarInternal,B=i(1300).RightToolbarRenderer,_=i(1307).WidgetBarTabButtonViewModel,W=i(1308).Hider,C=i(67),P=i(19),M=i(162),i(1309),o.widgetConfig={reuters_calendar:{title:$.t("Economic Calendar"),ctor:null,lazyLoad:!0,icon:"economic-calendar",options:{widgetType:"widgetbar"}},earnings_calendar:{title:$.t("Earnings Calendar"),ctor:null,lazyLoad:!0,icon:"earnings-calendar"},watchlist:{title:$.t("Watchlist"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0},hotlist:{title:$.t("Hotlist"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0},detail:{title:$.t("Details"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0},news:{title:$.t("News"),ctor:null},chat:{title:$.t("Talks"),ctor:null,chartWidgetAllowed:!0,lazyLoad:!0,doNotClearNotifications:!0},messages:{title:$.t("Recent Chats"),ctor:null,chartWidgetAllowed:!0,doNotClearNotifications:!0},messages_with_select:{title:$.t("Recent Chats"),ctor:null,chartWidgetAllowed:!0,doNotClearNotifications:!0,options:{layoutWithSelect:!0},emptyHeader:!0},notifications_user:{title:$.t("Notifications"),ctor:null,options:{type:"user"},chartWidgetAllowed:!0},notifications_following:{title:$.t("Ideas Stream"),ctor:null,options:{type:"following"},chartWidgetAllowed:!0},datawindow:{title:$.t("Data Window"),ctor:null,chartWidgetAllowed:!0,chartWidgetRequired:!0},publicchats:{title:$.t("All Talks"),ctor:null,lazyLoad:!0,doNotClearNotifications:!0},publicchats_with_select:{title:$.t("All Talks"),ctor:null,doNotClearNotifications:!0,options:{layoutWithSelect:!0},emptyHeader:!0},notes:{title:$.t("My Ideas"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0},alerts_manage:{title:$.t("Manage Alerts"),ctor:null,chartWidgetAllowed:!0},alerts_log:{title:$.t("Alerts Log"),ctor:null,chartWidgetAllowed:!0},market_summary:{title:$.t("Market Summary"),ctor:null}},o.svgIcons={},o._messageHandlers=[],o.postMessage=function(t,e){o._messageHandlers.forEach(function(i){i.handler(t,e)})},o.onMessage=function(t){"function"==typeof t&&o._messageHandlers.push({handler:t,widget:this})},o.prototype.destroy=function(){this._internal.destroy(),this._internal=null},
o.prototype.initLayout=function(){var t=this;g.load(c,function(){var e=$.Deferred();return u.loadWidgetBarModules(function(i){var n=t.widgetConfig;n.reuters_calendar.ctor=i.ReutersCalendarWidget,n.earnings_calendar.ctor=i.CalendarWidget&&i.CalendarWidget.Earnings,n.watchlist.ctor=i.Watchlist&&i.Watchlist.Widget,n.hotlist.ctor=i.HotlistWidget,n.detail.ctor=i.Detail&&i.Detail.Widget,n.news.ctor=i.NewsWidget,n.chat.ctor=i.ChatWidget,n.messages.ctor=i.Messages&&i.Messages.Widget,n.messages_with_select.ctor=i.Messages&&i.Messages.Widget,n.notifications_following.ctor=i.NotificationsWidgets,n.notifications_user.ctor=i.NotificationsWidgets,n.publicchats.ctor=i.PublicChatsWidget,n.publicchats_with_select.ctor=i.PublicChatsWidget,n.notes.ctor=i.NotesWidget,n.alerts_manage.ctor=i.AlertsManageWidget,n.alerts_log.ctor=i.AlertsLogWidget,n.market_summary.ctor=i.MarketSummaryWidget,e.resolve(i)}),e.promise()},this.options.instantLoad),g.onReady(c,function(){t.layout.startWidgets()}),t.layout.requestOptimalWidth(),this.layout.syncWidth(),this.layout.syncHeight(),t.layout.onVisibilityChange(),t.layout.updateResponsiveness()},o.prototype.loadWidgets=function(){this._widgetsLoadRequested||(this._widgetsLoadRequested=!0,g.load(c,null,!0))},o.prototype.onLoginStateChange=function(t){t||window.is_authenticated&&(this.dropWidgetData(),this.refreshFromTVSettings())},o.prototype.dropWidgetData=function(){for(var t in this.widgetConfig)delete this.widgetConfig[t].data},o.prototype.refreshFromTVSettings=function(){this._settingsPrefix&&(this.layout&&this.layout.destroy(),this.layout=new r({widgetBar:this}),this.loadFromTVSettings(),this.layout.createHTML(),this.layout.$pages.appendTo(this.$wrap),this.layout.$tabs.appendTo(this.$wrap),this.layout.$hider&&this.layout.$hider.appendTo(this.$wrap),this.initLayout())},o.prototype.getWidgets=function(t){var e,i=[];for(e=0;e<this.layout.pages.length;++e)i=i.concat(this.layout.pages[e].getWidgets(t));return i},o.prototype.loadFromTVSettings=function(){var t,e,i,n,s;if(this._settingsPrefix){try{this.migrateFromOld()}catch(t){console.error&&console.error(t)}if(t=this.getLayoutState(),t=this.mergeProperties(t),this.layout.demarshal(t,{settingsPrefix:this._settingsPrefix}),this.saveToTVSettings(),e=TVSettings.getJSON(this._settingsPrefix+"."+v.layoutKeyName,null)){i=[];for(n in e.widgets)i=i.concat(e.widgets[n].map(function(t){return t.id}));s=TVSettings.keysMask(this._settingsPrefix+".widget.*.*"),s&&s.forEach(function(t){var e=t.replace(this._settingsPrefix+".widget.","");-1===i.indexOf(e)&&0===t.indexOf(this._settingsPrefix+".widget.")&&(m("Settings debug","loadFromTVSettings: "+t,user.username),TVSettings.remove(t))}.bind(this))}}},o.prototype.mergeProperties=function(t){var e,i,n,s,a,o=TVSettings.getJSON(this._settingsPrefix+"."+v.layoutKeyName,null);if(!o)return t;for(o.settings&&$.extend(t,o.settings),e={},i=0;i<t.pages.length;i++)for(n=0;n<t.pages[i].widgets.length;n++)s=t.pages[i].widgets[n],a=e[s.type]||0,o.widgets[s.type]&&o.widgets[s.type][a]&&$.extend(s,o.widgets[s.type][a]),e[s.type]=++a
;return t},o.prototype.migrateFromOld=function(t){var e,i,n,s,a,o,r,d=TVSettings.getJSON(this._settingsPrefix+".layout-fixed",null);if(d){e={settings:{}},"minimized"in d&&(e.settings.minimized=d.minimized),"width"in d&&(e.settings.width=d.width),"activeIndex"in d&&(e.settings.activeIndex=d.activeIndex),e.widgets={};for(i=0;i<d.pages.length;i++)for(n=d.pages[i].widgets||d.pages[i],a=0;a<n.length;a++)o=n[a],o.id?(s=o.id.replace(/\..*/,""),/^news_.+/.test(s)&&(s=o.type="news",TVSettings.setJSON(this._settingsPrefix+".widget."+o.id.replace(/news_[^.]*/,"news"),TVSettings.getValue(this._settingsPrefix+".widget."+o.id)),o.id=o.id.replace(/news_[^.]*/,"news"))):(s=o.type,/^news_.+/.test(s)&&(o.properties=o.properties||{},o.properties.provider=o.type.replace(/news_([^.]*).*/,"$1"),s=o.type="news")),e.widgets[s]?e.widgets[s].push(o):e.widgets[s]=[o];TVSettings.setJSON(this._settingsPrefix+"."+v.layoutKeyName,e)}else TVSettings.getJSON(this._settingsPrefix+".layout",null)&&(r=this.getWidgetProperties("watchlist"))&&(e={settings:{},widgets:{watchlist:[r]}},TVSettings.setJSON(this._settingsPrefix+"."+v.layoutKeyName,e));d&&TVSettings.remove(this._settingsPrefix+".layout-fixed"),TVSettings.getJSON(this._settingsPrefix+".layout",null)&&TVSettings.remove(this._settingsPrefix+".layout")},o.prototype.saveToTVSettings=function(){if(this._settingsPrefix){var t=this.layout.marshal();TVSettings.setJSON(this._settingsPrefix+"."+v.layoutKeyName,t)}},o.prototype.getWidgetProperties=function(t,e){var i,n;return e=e||0,i=this._settingsPrefix.replace(/\W/g,"\\$&")+".widget.",!!((n=TVSettings.keysMask(i+t+".*"))&&n.length&&(n=n.sort(),n[e]))&&{id:n[e].replace(i,"")}},o.prototype.getGenericLayoutState=function(t){var i,n,s=v.getDefaultState(),a=window.COUNTRY_CODE_TO_DEFAULT_EXCHANGE;for(a.default=a.en,i=[{_gaEvent:"General Widget",title:$.t("Watchlist, details and news"),name:"base",icon:"base",widgets:[{type:"watchlist",properties:t&&t.length?{list:t}:void 0},{type:"detail"},{type:"news",properties:{provider:{base:"yahoo",ru:"djforex",en:"yahoo",tr:"bloomberght",pl:"yahoo",kr:"edali",id:"keuangan"}}}]},e.enabled("alerts")?{_gaEvent:"Alerts",title:$.t("Alerts"),name:"alerts",icon:"alarm-clock",widgets:[{type:"alerts_manage",properties:{}},{type:"alerts_log",properties:{}}]}:null,{_gaEvent:"Data Window",title:$.t("Data Window"),name:"data-window",icon:"datawindow",widgets:[{type:"datawindow",isEnabled:f("datawindow")}]},{_gaEvent:"Hotlists",title:$.t("Hotlists"),name:"hotlist",icon:"hotlists",widgets:[{type:"hotlist",properties:{exchangeByLocale:a,groupByLocale:{default:"volume_gainers"}}},{type:"hotlist",properties:{exchangeByLocale:a,groupByLocale:{default:"percent_change_gainers"}}},{type:"hotlist",properties:{exchangeByLocale:a,groupByLocale:{default:"percent_change_loosers"}}}]},{_gaEvent:"Calendar",title:$.t("Calendar"),name:"calendar",icon:"calendar",widgets:[{type:"reuters_calendar",properties:{}},{type:"earnings_calendar",properties:{},isEnabled:f("earnings_calendar")}]},{_gaEvent:"My Ideas",title:$.t("My Ideas"),name:"notes",
icon:"notes",spaceBottom:!0,spaceBottomText:$.t("Social"),widgets:[{type:"notes"}]},{_gaEvent:"Public Chats",title:$.t("Public Chats"),name:"chats",icon:"chat",widgets:[{type:"chat"},{type:"publicchats"}]},{_gaEvent:"Private Chats",title:$.t("Private Chats"),name:"pm_chats",icon:"messages",widgets:[{type:"messages"}]},{_gaEvent:"Ideas Stream",title:$.t("Ideas Stream"),name:"ideas_stream",icon:"ideas-stream",widgets:[{type:"notifications_following"}]},{_gaEvent:"Notifications",title:$.t("Notifications"),name:"notifications",icon:"notifications",widgets:[{type:"notifications_user"}]}],n=0;n<i.length;n++)i[n]&&s.pages.push(i[n]);return s},o.prototype.getChartingPlatformLayoutState=function(t,e){var i,n,s={version:2,width:267,pages:[]};return(this._customization.watchlist||this._customization.details||this._customization.news)&&(i="",n=[],this._customization.watchlist&&(i=$.t("Watchlist"),n.push({type:"watchlist",id:"watchlist."+e,properties:t&&t.length?{list:t}:void 0})),this._customization.details&&(this._customization.watchlist?i+=" "+$.t("and details"):i=$.t("Details"),n.push({type:"detail"})),this._customization.news&&(this._customization.watchlist||this._customization.details?i+=" and news":i="News",n.push({type:"news",id:"news."+e})),s.pages.push({title:i,icon:"base",widgets:n})),s},o.prototype.getLayoutState=function(){function t(t){return!(void 0!==t.isEnabled&&!t.isEnabled)&&(a.chartWidgetCollection||!o.widgetConfig[t.type].chartWidgetRequired)}var i,n,s,a=this,r=TVSettings.getJSON("watchlist.list",[]);for(i=e.enabled("cqg_terminal")?this.getChartingPlatformLayoutState(r,"cqg"):e.enabled("trading_terminal")?this.getChartingPlatformLayoutState(r,"terminal"):this.getGenericLayoutState(r),n=i.pages.length-1;n>=0;n--)s=i.pages[n],s.widgets=$.grep(s.widgets,t);return i.pages=$.grep(i.pages,function(t){return t.widgets&&t.widgets.length}),i},o.prototype.createWidgetId=function(t){return t+"."+y.randomHash()},o.prototype.setPage=function(t){this.layout.setMinimizedState(!1);var e=this.layout.activeIndex;return this.layout.pages.forEach(function(i,n){i.name===t&&(e=n)}),this.layout.switchPage(e),this.layout.getActivePage()},r.prototype.startWidgets=function(){this.pages.forEach(function(t){t.widgets.forEach(function(t){t.widgetObject||t.widgetStartDelayed||setTimeout(function(){t.startWidget()},0)})});var t=this.getActivePage();t&&t.onActiveStateChange(!0)},r.prototype.syncHeight=function(){var t,e=this.widgetBar.resizerBridge.height.value();this.$pages.css("height",e+"px"),this.minimized||(t=this.getActivePage())&&t.updateWidgetsHeight()},r.prototype.tabsWidth=function(){return e.enabled("widgetbar_tabs")?v.tabsWidth:this.minimized?v.hiderGapWidth:0},r.prototype.borderWidth=function(){return v.borderWidth},r.prototype.canOpen=function(){return this.MIN_WIDTH+this.tabsWidth()+this.borderWidth()<=this.widgetBar.resizerBridge.availWidth.value()},r.prototype.requestWidth=function(t){var e,i,n=this.widgetBar.resizerBridge;t>0&&(t+=this.borderWidth()),e=this.tabsWidth(),i=t+e,
this.canOpen()?n.width.value()!==i&&n.negotiateWidth([{min:e,max:e},{min:this.MIN_WIDTH+e,max:i}]):n.negotiateWidth(0)},r.prototype.requestOptimalWidth=function(){this.changeWidgetsButtonTitle(),this.minimized?this.requestWidth(0):this.requestWidth(this.width)},r.prototype.updateResponsiveness=function(){var t=!this.canOpen();this.$tabs.toggleClass("js-hidden",t),this.$pages.toggleClass("js-hidden",t)},r.prototype.syncWidth=function(){var t,e,i=this.widgetBar.resizerBridge,n=this.tabsWidth(),s=this.borderWidth(),a=i.width.value(),o=Math.max(a-n-s,0)||0;o<this.MINIMIZE_THRESHOLD?this.setMinimizedState(!0):this.setMinimizedState(!1),this.$pages.css("width",o+"px").toggleClass("hidden",!!this.minimized),this.minimized||(t=this.getActivePage(),t&&t.widgets.forEach(function(t){t.onWidthChange(o)}),this.widgetBar&&this.widgetBar.loadWidgets()),e=!this.canOpen(),this.$deviceButton&&this.$deviceButton.toggleClass("js-hidden",!e||!this.minimized)},r.prototype.setMinimizedState=function(t){t=!!t,!!this.minimized!==t&&(this.minimized=t,this.isMinimized.setValue(this.minimized),t&&this.widgetBar.resizerBridge.exitFullscreen(),this.requestOptimalWidth(),this.pages[this.activeIndex].onActiveStateChange(!this.minimized))},r.prototype.getWidgetsButtonTitle=function(){return this.minimized?window.t("Show Widgets"):window.t("Hide Widgets")},r.prototype.changeWidgetsButtonTitle=function(){this.widgetBar.$widgetBarBtn&&this.widgetBar.$widgetBarBtn.attr("title",this.getWidgetsButtonTitle())},r.prototype.switchPage=function(t){var e,i,n;if(-1===t||0===this.pages.length)return this.activeIndex=-1,void this.activePageIndex.setValue(this.activeIndex);if(t instanceof d){if(-1===(e=this.pages.indexOf(t)))return}else e=+t;i=this.pages[this.activeIndex],this.activeIndex=Math.min(this.pages.length-1,Math.max(0,e)),this.activePageIndex.setValue(this.activeIndex),n=this.pages[this.activeIndex],this.activeName=n.name,this.minimized||i&&i===n||(i&&i.onActiveStateChange(!1),n&&n.onActiveStateChange(!0))},r.prototype.getActivePage=function(){return this.minimized?null:this.pages[this.activeIndex]||null},r.prototype.onTabClick=function(t,e){if(!t.isDefaultPrevented()){var i=this.pages.indexOf(e);-1!==i&&(t.preventDefault(),i!==this.activeIndex||this.minimized?(e._gaEvent&&m("Platform Widgets",e._gaEvent),this.switchPage(i),this.minimized&&this.setMinimizedState(!1)):this.setMinimizedState(!0),this.widgetBar&&this.widgetBar.saveToTVSettings())}},o.prototype.ensureBugReportButtonViewModel=function(){if(this._bugReportButtonViewModel)return this._bugReportButtonViewModel;var t=this._bugReportButtonViewModel=new _({icon:i(1310),hint:$.t("Contact Support"),onClick:function(){runOrSignIn(function(){t.isActive.setValue(!0),g.onReady(c,function(e){var i,n,s=e.ReportBugDialog;s&&(i=(new s).open(),i.on("beforeOpen",function(){t.isActive.setValue(!0)}),i.on("destroy",function(){t.isActive.setValue(!1)}),n=i.$el,w.width<w.widgetbarBreakpoint&&n.css("position","fixed"))}),g.load(c,null,0)},{source:"Bug report dialog",sourceMeta:"Chart"})}});return t},
o.prototype.ensureHelpButtonViewModel=function(){var t,e,n,s;return this._helpButtonViewModel?this._helpButtonViewModel:(t=this.ensureBugReportButtonViewModel(),e=this.options,n=null,s=this._helpButtonViewModel=new _({icon:i(1311),hint:$.t("Help"),onClick:function(i){var a=i.currentTarget;g.onReady(c,function(i){var o=i.ChartHelpMenu;o&&(null===n&&(n=new o(s,t,e.showWizardFn,e.areShortcutsAvailable)),n.isOpened()?n.close():n.open(a))}),g.load(c,null,0)}}))},r.prototype.onLayoutResizeHandleMousedown=function(t){function e(t){var e,i,o;e=t.originalEvent.touches?t.originalEvent.touches[0].clientX:t.pageX,i=e-a,o=s-i,o<n.MINIMIZE_THRESHOLD?o=0:o<n.MIN_WIDTH&&(o=n.MIN_WIDTH),o>0&&(n.width=o),n.requestWidth(o)}function i(t){$(document.documentElement).off("mousemove touchmove",e).off("mouseup touchend",i),n.widgetBar&&n.widgetBar.saveToTVSettings(),n.changeWidgetsButtonTitle()}var n,s,a;t.isDefaultPrevented()||(t.preventDefault(),n=this,s=Math.max(this.widgetBar.resizerBridge.width.value()-this.tabsWidth()-this.borderWidth(),0),a=t.originalEvent.touches?t.originalEvent.touches[0].clientX:t.pageX,$(document.documentElement).on("mousemove touchmove",e).on("mouseup touchend",i))},r.prototype.removePage=function(t){var e=this.pages.indexOf(t);-1!==e&&(delete t.widgetBarLayout,this.pages.splice(e,1),t.$page.detach(),t.$page.detach(),t.$tab.detach(),this.activeIndex===e&&this.switchPage(e-1))},r.prototype.createPage=function(){var t=new d({widgetBarLayout:this});return this.pages.push(t),t.createHTML(),this.$pagescontent.append(t.$page),t},r.prototype.createWidget=function(t,e){if(e){if(-1===this.pages.indexOf(e))return null}else e=this.createPage();var i=new l({widgetBarPage:e});return i.demarshal({type:t}),i.createHTML(),e.attachWidget(i),i},r.prototype.widgetInsertionDisallowed=function(t){return"watchlist"===t&&((!window.user||!user.is_pro)&&(!!this.pages.some(function(e){return e.widgets.some(function(e){return e.type===t})})||void 0))},r.prototype.onVisibilityChange=function(){var t=!(!this.widgetBar||!this.widgetBar.resizerBridge.visible.value());this.visible=t,this.pages.forEach(function(e){e.onVisibilityChange(t)})},r.prototype.destroy=function(){var t,e,i,n,s;for(this.widgetBar&&this.widgetBar.layout===this&&delete this.widgetBar.layout,this.tabRenderer&&(this.tabRenderer.destroy(),this.tabRenderer=null),this.$hider&&(t=this.$hider.get(0),C.unmountComponentAtNode(t)),e=this.pages.length;e--;)for(i=this.pages[e],n=i.widgets.length;n--;)i.widgets[n].destroy();for(s in this)this[s]instanceof $&&this[s].remove(),delete this[s]},r.prototype.getWidgetBarOption=function(){if(this.widgetBar&&name in this.widgetBar)return this.widgetBar[name]},r.prototype.MIN_WIDTH=200,r.prototype.MINIMIZE_THRESHOLD=50,r.prototype.width=290,r.prototype.minimized=!1,r.prototype.activeIndex=0,r.prototype.activeName="",r.prototype.visible=!0,d.prototype.onActiveStateChange=function(t){t=!!t,$(this.$page).toggleClass("active",!!t),this.tab.onActiveStateChange(t),t&&this.updateWidgetsHeight({skipIfHeightUnchanged:!0}),
this.widgets.forEach(function(e){e.onActiveStateChange(t)})},d.prototype.updateWidgetsHeight=function(t){var e,i,n,s,a,o,r,d,l,h,c;if(this.$page&&this.widgetBarLayout&&this.widgetBarLayout.widgetBar){if(this.widgetBarLayout.getActivePage()!==this)return void(this._invalidated=!0);if(t=t||{},e=this.widgetBarLayout.widgetBar.resizerBridge.height.value(),this._pageHeight===e&&t.skipIfHeightUnchanged||(this._invalidated=!0,this._pageHeight=e),this._invalidated){for(i=e,s=0,a=this.widgets,o=null,r=this.widgets.length;r--;)if(this.widgets[r].widgetMaximized.value()){o=this.widgets[r];break}if(o){for(r=this.widgets.length;r--;)(d=a[r])!==o&&d.setHeight(0);a=[o]}for(i-=this.widgets.length-1,r=a.length;r--;)d=a[r],d.$widget&&(void 0===n&&(n=d.$header.outerHeight(!0)),i-=n,s+=d.heightRatio);for(l=i/s,h=a.length-1,r=0;r<=h;r++)d=a[r],c=r===h?i:Math.round(l*d.heightRatio),d.setHeight(c),i-=c}}},d.prototype.onWidgetResizeHandleMousedown=function(t,e){var i,n,s,a,o,r,d,l,h,c,g,u;if(!t.isDefaultPrevented()){for(i=this,t.preventDefault(),a=this.widgets.length-1;a>0;a--)this.widgets[a]===e&&(n=this.widgets[a],s=this.widgets[a-1]);o=t.originalEvent.touches?t.originalEvent.touches[0].clientY:t.pageY,r=s._rdState.bridge().height.value(),d=s.heightRatio+n.heightRatio,l=r+n._rdState.bridge().height.value(),0!==l&&(c=!1,g=function(t){var e,a,g;c||i.$page.addClass("widget-resize-mode"),e=t.originalEvent.touches?t.originalEvent.touches[0].clientY:t.pageY,a=e-o,g=Math.max(0,Math.min(r+a,l)),h!==g&&(h=g,s.heightRatio=g/l*d,n.heightRatio=d-s.heightRatio,s.setHeight(g),n.setHeight(l-g))},u=function(t){$(document.documentElement).off("mousemove touchmove",g).off("mouseup touchend",u),i.$page.removeClass("widget-resize-mode"),h!==r&&(i.normalizeRatios(),i.widgetBarLayout&&i.widgetBarLayout.widgetBar&&i.widgetBarLayout.widgetBar.saveToTVSettings())},$(document.documentElement).on("mousemove touchmove",g).one("mouseup touchend",u))}},d.prototype.normalizeRatios=function(){var t,e,i,n=1/0;for(t=this.widgets.length;t--;)(e=this.widgets[t].heightRatio)<=0||!isFinite(e)||e<n&&(n=e);if(isFinite(n)){for(i=1;n<1;)n*=2,i*=2;for(;n>=2;)n/=2,i/=2;for(t=this.widgets.length;t--;)this.widgets[t].heightRatio*=i}},d.prototype.attachWidget=function(t,e){var i,n;e=+e,i=this.widgets.indexOf(t),-1!==i?this.widgets.splice(i,1):t.widgetBarPage&&t.widgetBarPage!==this&&t.widgetBarPage.removeWidget(t),e<this.widgets.length?e<0&&(e=0):e=this.widgets.length,delete t.widgetBarPage,Object.defineProperty(t,"widgetBarPage",{value:this,configurable:!0}),this.widgets.splice(e,0,t),n=this.widgets[e+1],n?t.$widget.insertBefore(n.$widget):t.$widget.appendTo(this.$page),this.widgetBarLayout&&this.widgetBarLayout.getActivePage(),this.updateWidgetsHeight(),t.updateVisibleWatchedValue()},d.prototype.removeWidget=function(t){var e=this.widgets.indexOf(t);-1!==e&&(delete t.widgetBarPage,this.widgets.splice(e,1),t.$widget&&t.$widget.detach(),this.updateWidgetsHeight())},d.prototype.remove=function(){this.widgetBarLayout&&this.widgetBarLayout.removePage(this)},
d.prototype.destroy=function(){this.remove();for(var t in this)this[t]instanceof $&&this[t].remove(),delete this[t]},d.prototype.isActiveAndVisible=function(){var t=this.widgetBarLayout;return!(!t||!t.visible)&&t.getActivePage()===this},d.prototype.onVisibilityChange=function(t){var e=t&&this.widgetBarLayout&&this.widgetBarLayout.getActivePage()===this;this.widgets.forEach(function(i){e&&i.clearNotifications(),i.onVisibilityChange(t)})},d.prototype.notify=function(t,e){if(e=e||{},!0===e.clear)return void this.clearNotifications();e.stopHighlightTab||(this.notificationCounter=this.notificationCounter+(~~t||1),this.updateNotifications(e.notificationValue))},d.prototype.clearNotifications=function(){this.notificationCounter=0,this.tab.updateNotifications(this.notificationCounter)},d.prototype.updateNotifications=function(t){var e="number"==typeof t?t:this.notificationCounter;this.tab.updateNotifications(e)},d.prototype.notificationCounter=0,d.prototype.getWidgets=function(t){var e,i,n=[];for(e=0;e<this.widgets.length;++e)i=this.widgets[e],i.type===t&&n.push(i);return n},l.prototype.setHeight=function(t){this._internalState.body.value()&&this._internalState.body.value().height(t),this._internalState.height.setValue(t)},l.prototype.onWidthChange=function(t){this._internalState.width.setValue(t)},l.prototype.remove=function(){this.widgetBarPage&&this.widgetBarPage.removeWidget(this)},l.prototype.destroy=function(){this.widgetObject&&"function"==typeof this.widgetObject.destroy&&this.widgetObject.destroy(),this.remove(),this.symbolLinking&&(this.symbolLinking.destroy(),this.symbolLinking=null),this.intervalLinking&&(this.intervalLinking.destroy(),this.intervalLinking=null),this.widgetVisible&&(this.widgetVisible.unsubscribe(),this.widgetVisible=null),this.widgetActive&&(this.widgetActive.unsubscribe(),this.widgetActive=null),this.watchedHeight&&(this.watchedHeight.unsubscribe(),this.watchedHeight=null),this.watchedWidth&&(this.watchedWidth.unsubscribe(),this.watchedWidth=null),this.widgetMaximized&&(this.widgetMaximized.unsubscribe(),this.widgetMaximized=null);for(var t in this)this[t]instanceof $&&this[t].remove(),delete this[t];o._messageHandlers=o._messageHandlers.filter(function(t){return t.widget!==this},this)},l.prototype.onActiveStateChange=function(t){var e=this.getWidgetBarOption("widgetConfig")||o.widgetConfig,i=e[this.type];this.$icon&&this.$icon.toggleClass("active",!!t),t&&!i.doNotClearNotifications&&this.clearNotifications(),this.updateVisibleWatchedValue(),this.widgetActive.setValue(!!t)},l.prototype.toggleMaximize=function(t){if("boolean"!=typeof t)t=!this.widgetMaximized.value();else if(t===this.widgetMaximized.value())return;this.widgetMaximized.setValue(t),this.widgetBarPage&&this.widgetBarPage.widgetBarLayout&&this.widgetBarPage.widgetBarLayout.widgetBar&&this.widgetBarPage.widgetBarLayout.widgetBar.saveToTVSettings(),this.widgetBarPage&&this.widgetBarPage.updateWidgetsHeight()},l.prototype.startWidget=function(){var t,e,i,s,a,r,d
;if(!this.widgetObject&&!this.widgetStartDelayed&&(t=this.getWidgetBarOption("widgetConfig")||o.widgetConfig,(e=t[this.type])&&(i=e.ctor))){if(s=this,this.widgetVisible=this.widgetVisible||new n,this.updateVisibleWatchedValue(),e.lazyLoad&&!this.widgetVisible.value())return this.widgetStartDelayed=!0,void this.widgetVisible.when(function(){delete s.widgetStartDelayed,s.startWidget()});this.symbolLinking=p.symbol.spawn(),this.intervalLinking=p.interval.spawn(),a=this._rdState.bridge(),r={$widget:this.$widget,$header:this.$header,$headerspace:this.$headerspace,$body:$(a.body.value()),body:a.body,properties:this.properties,notify:this.notify.bind(this),clearNotifications:this.clearNotifications.bind(this),visible:this.widgetVisible.readonly(),active:this.widgetActive.readonly(),symbol:this.symbolLinking,interval:this.intervalLinking,height:a.height,width:a.width,setTitle:this.setTitle.bind(this),setTitleHtml:this.setTitleHtml.bind(this),id:this.id,toggleMaximize:this.toggleMaximize.bind(this),maximized:this.widgetMaximized.readonly(),postMessage:o.postMessage.bind(this),onMessage:o.onMessage.bind(this),hideDetach:!1},e.chartWidgetAllowed&&(d=function(){return s.widgetBarPage&&s.widgetBarPage.widgetBarLayout&&s.widgetBarPage.widgetBarLayout.widgetBar&&s.widgetBarPage.widgetBarLayout.widgetBar.chartWidgetCollection},r.getChartWidget=function(){var t=d();return t?t.activeChartWidget.value():null},r.getChartWidgetCollection=function(){return d()||null}),null!=this.readonly?this.readonly&&(r.readonly=!0):this.getWidgetBarOption("readonly")&&(r.readonly=!0),null!=e.options&&(r.options=e.options),null!=this.stateData?r.data=this.stateData:null!=e.data&&(r.data=e.data),this.widgetObject=new i(r),this._widgetStarted.fire(this)}},l.prototype.widgetStarted=function(){return this._widgetStarted},l.prototype.notify=function(t,e){if(e=e||{},this.widgetBarPage&&(!this.widgetBarPage.isActiveAndVisible()||e.force))return this.widgetBarPage.notify(t,e)},l.prototype.clearNotifications=function(){if(this.widgetBarPage)return this.widgetBarPage.clearNotifications()},d.prototype.isActiveAndVisible=function(){var t=this.widgetBarLayout;return!(!t||!t.visible)&&t.getActivePage()===this},l.prototype.onVisibilityChange=function(t){this.updateVisibleWatchedValue()},l.prototype.updateVisibleWatchedValue=function(){this.widgetVisible&&this.widgetVisible.setValue(!!this.widgetBarPage&&this.widgetBarPage.isActiveAndVisible())},l.prototype.setTitle=function(t){this.customTitle=t+"",this.$title&&this.$title.text(this.getTitle())},l.prototype.setTitleHtml=function(t){this.$title&&this.$title.html(t)},l.prototype.heightRatio=1,l.prototype.getWidgetBarOption=function(t){if(this.widgetBarPage&&this.widgetBarPage.widgetBarLayout&&this.widgetBarPage.widgetBarLayout.widgetBar&&t in this.widgetBarPage.widgetBarLayout.widgetBar)return this.widgetBarPage.widgetBarLayout.widgetBar[t]},h.prototype.value=function(t){return this._value},h.prototype.setValue=function(t,e){return this._value=t,
this._settingsKey&&(null==t?(m("Settings debug","WigdetProperties.setValue: "+this._settingsKey,user.username),TVSettings.remove(this._settingsKey)):TVSettings.setJSON(this._settingsKey,t,e)),this._value},o.prototype.createHTML=function(){var t=this.$container;!t||t.size()<1||(t.empty(),this.layout.createHTML(),this.$wrap=$(document.createElement("div")).attr("class","widgetbar-wrap unselectable js-right-boundary").appendTo(t),this.$wrap.toggleClass("fullscreen",this.fullscreen),this.layout.$pages.appendTo(this.$wrap),e.enabled("widgetbar_tabs")&&this.layout.$tabs.appendTo(this.$wrap),this.layout.$deviceButton&&this.$wrap.append(this.layout.$deviceButton),this.layout.$hider&&this.layout.$hider.appendTo(this.$wrap))},r.prototype.createHTML=function(){var t,i,n,s,a=this;a.$tabs=a.$tabscontent=$(),e.enabled("widgetbar_tabs")&&(a.$tabs=$('<div class="widgetbar-tabs">'),a.tabRenderer&&(a.tabRenderer.destroy(),a.tabRenderer=null),t=a.widgetBar,i=t._internal,n={tabs:a.pages,isDomButtonAvailable:i.isDomButtonAvailable(),isBugReportButtonAvailable:i.isBugReportButtonAvailable(),isHelpButtonAvailable:i.isHelpButtonAvailable(),widgetBar:t},a.tabRenderer=new B(a.$tabs[0],n),this.widgetBar.adaptive),a.$pages=$(document.createElement("div")).attr("class","widgetbar-pages"),a.$pagescontent=$(document.createElement("div")).attr("class","widgetbar-pagescontent").appendTo(a.$pages),e.enabled("widgetbar_tabs")||a.$pages.css("right","-1px"),this.widgetBar.fullscreen||(a.$handle=$(document.createElement("div")).attr("class","widgetbar-handle").appendTo(a.$pages),a.$handle.on("mousedown touchstart",a.onLayoutResizeHandleMousedown.bind(a))),this.widgetBar.showCloseButton&&(a.$hider=$(document.createElement("div")).addClass("widgetbar-hider"),s=function(){var t=a.$hider.get(0);t.classList.toggle("widgetbar-hider--closed",a.isMinimized.value()),t.classList.toggle("js-hidden",e.enabled("widgetbar_tabs")&&a.isMinimized.value()),C.render(P.createElement(W,{isMinimized:a.isMinimized.value(),onClick:function(){a.setMinimizedState(!a.minimized)}}),t)},a.isMinimized.subscribe(s),s()),a.pages.forEach(function(t){t.createHTML(),t.$page.appendTo(a.$pagescontent)})},d.prototype.createHTML=function(){var t=this;t.$page=$(document.createElement("div")).attr("class","widgetbar-page"),t.widgets.forEach(function(e){e.createHTML(),e.$widget.appendTo(t.$page)})},d.prototype.createTabButtonViewModel=function(){var t=this;t.tab=new _({icon:o.svgIcons[t.icon],hint:t.title,onClick:function(e){t.widgetBarLayout&&t.widgetBarLayout.onTabClick(e,t)}})},l.prototype.getTitle=function(t){var e=a(this.type,this.getWidgetBarOption("widgetConfig"));return t&&this.customTitle&&e?this.customTitle.substr(0,e.length)===e?this.customTitle:e+": "+this.customTitle:this.customTitle||e||$.t("Widget")},l.prototype.createHTML=function(){var t,e=this,i=!!e.widgetConfig&&(!!e.widgetConfig.icon&&e.widgetConfig.icon),n=e.widgetConfig&&e.widgetConfig.emptyHeader;e.$widget=$(document.createElement("div")).attr("class","widgetbar-widget widgetbar-widget-"+e.type),
e.$header=$(document.createElement("div")).attr("class","widgetbar-widgetheader").appendTo(e.$widget),i&&(e.$headericon=$(document.createElement("div")).attr("class","widgetbar-widgetheader-icon widgetbar-widgetheader-icon-"+i).append($(o.svgIcons[i])).appendTo(e.$header)),e.$headerspace=$(document.createElement("div")).attr("class","widgetbar-headerspace").appendTo(e.$header),e.$headerspace.on("click",function(t){t.preventDefault()}),n||(e.$title=$(document.createElement("div")).attr("class","widgetbar-widgettitle").appendTo(e.$header),e.$title.text(this.getTitle())),t=$(document.createElement("div")).attr("class","widgetbar-widgetbody").appendTo(e.$widget),e._internalState.body.setValue(t),e.$resizehandle=$(document.createElement("div")).attr("class","widgetbar-widgethandle").appendTo(e.$widget),e.$resizehandle.on("mousedown touchstart",function(t){e.widgetBarPage&&e.widgetBarPage.onWidgetResizeHandleMousedown(t,e)}),!0===this.maximized&&(this.toggleMaximize(!0),delete this.maximized)},r.demarshal=function(t,e){return(new r).demarshal(t,e)},d.demarshal=function(t,e){return(new d).demarshal(t,e)},l.demarshal=function(t,e){return(new l).demarshal(t,e)},r.prototype.demarshal=function(t,e){var i,n,s,a;if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t&&"object"==typeof t?(this.width=+t.width,!isFinite(this.width)||this.width<=0?delete this.width:this.width<this.MIN_WIDTH&&(this.width=this.MIN_WIDTH),"minimized"in t?(this.minimized=!!t.minimized,this.isMinimized.setValue(this.minimized)):(delete this.minimized,this.isMinimized.setValue(this.minimized)),"version"in t&&(this.version=t.version),i=+t.activeIndex,n=t.activeName,s=!1,a=this.pages,a.splice(0,this.pages.length),Array.isArray(t.pages)&&t.pages.forEach(function(t,o){var r=new d({widgetBarLayout:this}).demarshal(t,e);n?t.name===n&&r&&(i=o,s=!0):r||o!==i||i--,r&&a.push(r)},this),n&&!s&&(i=0),0===a.length?(this.activeIndex=-1,this.activePageIndex.setValue(this.activeIndex)):i>=0&&i<a.length&&(this.activeIndex=i,this.activePageIndex.setValue(this.activeIndex)),this):null},d.prototype.demarshal=function(t,e){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}if(!t||!t.widgets||!Array.isArray(t.widgets))return null;var i=this.widgets;return i.splice(0,i.length),this._gaEvent=t._gaEvent,this.title=t.title,this.name=t.name,this.icon=t.icon,this.spaceBottom=t.spaceBottom,this.spaceBottomText=t.spaceBottomText,this.createTabButtonViewModel(),t.widgets.forEach(function(t){var n=new l({widgetBarPage:this}).demarshal(t,e);n&&i.push(n)},this),0===i.length?null:this},l.prototype.demarshal=function(t,e){var i,n,s;if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t&&"object"==typeof t?("id"in t?(this.id=t.id+"",this.type=this.id.replace(/\..*/,"")):"type"in t?(this.type=t.type+"",this.id=o.prototype.createWidgetId(this.type)):(delete this.type,delete this.id),null!=t.readonly?this.readonly=!!t.readonly:delete this.readonly,this.stateData=t.data,isFinite(+t.heightRatio)&&+t.heightRatio>=0?this.heightRatio=+t.heightRatio:delete this.heightRatio,
!0===t.maximized&&(this.maximized=!0),t.settingsKey?i=t.settingsKey:this.id&&(n=this.getWidgetBarOption("_settingsPrefix"))&&(i=n+".widget."+this.id),this.properties=new h({widgetBarWidget:this,settingsKey:i}),null==t.properties||i&&null!==this.properties.value()||this.properties.setValue(t.properties),"news"!==this.type&&"hotlist"!==this.type||!i||this.properties.setValue($.extend(!0,{},t.properties,this.properties.value())),"hotlist"===this.type&&!i&&t.properties&&this.properties.setValue(t.properties),this.widgetConfig=null,s=this.getWidgetBarOption("widgetConfig"),s[this.type]&&(this.widgetConfig=s[this.type]),this):null},r.prototype.marshal=function(t){var e,i,n,s,a=[];for(this.pages.forEach(function(e){var i=e.marshal(t);i&&(a=a.concat(i))}),e={},i=0;i<a.length;i++)a[i].type&&(n=a[i].type,a[i].id&&delete a[i].type,e[n]?e[n].push(a[i]):e[n]=[a[i]]);return s={widgets:e,settings:{}},["minimized","width","activeIndex","version","activeName"].forEach(function(t){this[t]!==r.prototype[t]&&(s.settings[t]=this[t])},this),s},d.prototype.marshal=function(t){var e=[];return this.widgets.forEach(function(i){var n=i.marshal(t);n&&e.push(n)}),0===e.length?null:e},l.prototype.marshal=function(t){var e={};return this.id&&(e.id=this.id),this.type&&(e.type=this.type),["heightRatio"].forEach(function(t){this[t]!==l.prototype[t]&&(e[t]=this[t])},this),this.widgetMaximized.value()&&(e.maximized=!0),t&&t.includeWidgetProperties&&this.properties&&(e.properties=TradingView.clone(this.properties.value())),e},t.exports.WidgetBar=o}).call(e,i(4),i(15),i(8))},989:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 10" width="20" height="10"><path fill="none" stroke="currentColor" stroke-width="1.5" d="M2 1l8 8 8-8"/></svg>'}});